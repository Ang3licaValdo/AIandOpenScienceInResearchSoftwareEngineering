<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve"
    xmlns="http://www.tei-c.org/ns/1.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
    xmlns:xlink="http://www.w3.org/1999/xlink">
    <teiHeader xml:lang="en">
        <fileDesc>
            <titleStmt>
                <title level="a" type="main">Seven Golden Rules for heuristic filtering of molecular formulas obtained by accurate mass spectrometry</title>
            </titleStmt>
            <publicationStmt>
                <publisher>Springer Science and Business Media LLC</publisher>
                <availability status="unknown">
                    <p>Copyright Springer Science and Business Media LLC</p>
                </availability>
                <date type="published" when="2007-03-27">27 March 2007</date>
            </publicationStmt>
            <sourceDesc>
                <biblStruct>
                    <analytic>
                        <author>
                            <persName>
                                <forename type="first">Tobias</forename>
                                <surname>Kind</surname>
                            </persName>
                            <email>tkind@ucdavis.edu</email>
                            <affiliation key="aff0">
                                <orgName type="institution">University of California Davis</orgName>
                                <address>
                                    <addrLine>451 E. Health Sci. Dr</addrLine>
                                    <postCode>95616</postCode>
                                    <settlement>Genome Center, Davis</settlement>
                                    <region>CA</region>
                                    <country key="US">USA</country>
                                </address>
                            </affiliation>
                        </author>
                        <author>
                            <persName>
                                <forename type="first">Oliver</forename>
                                <surname>Fiehn</surname>
                            </persName>
                            <email>ofiehn@ucdavis.edu</email>
                            <affiliation key="aff0">
                                <orgName type="institution">University of California Davis</orgName>
                                <address>
                                    <addrLine>451 E. Health Sci. Dr</addrLine>
                                    <postCode>95616</postCode>
                                    <settlement>Genome Center, Davis</settlement>
                                    <region>CA</region>
                                    <country key="US">USA</country>
                                </address>
                            </affiliation>
                        </author>
                        <title level="a" type="main">Seven Golden Rules for heuristic filtering of molecular formulas obtained by accurate mass spectrometry</title>
                    </analytic>
                    <monogr>
                        <title level="j" type="main">BMC Bioinformatics</title>
                        <title level="j" type="abbrev">BMC Bioinformatics</title>
                        <idno type="eISSN">1471-2105</idno>
                        <imprint>
                            <publisher>Springer Science and Business Media LLC</publisher>
                            <biblScope unit="volume">8</biblScope>
                            <biblScope unit="issue">1</biblScope>
                            <date type="published" when="2007-03-27">27 March 2007</date>
                        </imprint>
                    </monogr>
                    <idno type="MD5">316876122B4BF56A6B5DE9FFE4DC11A2</idno>
                    <idno type="DOI">10.1186/1471-2105-8-105</idno>
                    <note type="submission">Received: 16 December 2006 Accepted: 27 March 2007</note>
                </biblStruct>
            </sourceDesc>
        </fileDesc>
        <encodingDesc>
            <appInfo>
                <application version="0.7.3-SNAPSHOT" ident="GROBID" when="2023-02-14T01:12+0000">
                    <desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
                    <ref target="https://github.com/kermitt2/grobid"/>
                </application>
            </appInfo>
        </encodingDesc>
        <profileDesc>
            <abstract>
                <div
                    xmlns="http://www.tei-c.org/ns/1.0">
                    <p>Background: Structure elucidation of unknown small molecules by mass spectrometry is a challenge despite advances in instrumentation. The first crucial step is to obtain correct elemental compositions. In order to automatically constrain the thousands of possible candidate structures, rules need to be developed to select the most likely and chemically correct molecular formulas.</p>
                    <p>Results: An algorithm for filtering molecular formulas is derived from seven heuristic rules: (1) restrictions for the number of elements, (2) LEWIS and SENIOR chemical rules, (3) isotopic patterns, (4) hydrogen/carbon ratios, (5) element ratio of nitrogen, oxygen, phosphor, and sulphur versus carbon, (6) element ratio probabilities and (7) presence of trimethylsilylated compounds. Formulas are ranked according to their isotopic patterns and subsequently constrained by presence in public chemical databases. The seven rules were developed on 68,237 existing molecular formulas and were validated in four experiments. First, 432,968 formulas covering five million PubChem database entries were checked for consistency. Only 0.6% of these compounds did not pass all rules. Next, the rules were shown to effectively reducing the complement all eight billion theoretically possible C, H, N, S, O, P-formulas up to 2000 Da to only 623 million most probable elemental compositions. Thirdly 6,000 pharmaceutical, toxic and natural compounds were selected from DrugBank, TSCA and DNP databases. The correct formulas were retrieved as top hit at 80-99% probability when assuming data acquisition with complete resolution of unique compounds and 5% absolute isotope ratio deviation and 3 ppm mass accuracy. Last, some exemplary compounds were analyzed by Fourier transform ion cyclotron resonance mass spectrometry and by gas chromatography-time of flight mass spectrometry. In each case, the correct formula was ranked as top hit when combining the seven rules with database queries.</p>
                </div>
                <div
                    xmlns="http://www.tei-c.org/ns/1.0">
                    <head>Conclusion:</head>
                    <p>The seven rules enable an automatic exclusion of molecular formulas which are either wrong or which contain unlikely high or low number of elements. The correct molecular formula is assigned with a probability of 98% if the formula exists in a compound database. For truly novel compounds that are not present in databases, the correct formula is found in the first three hits with a probability of 65-81%. Corresponding software and supplemental data are available for downloads from the authors' website.</p>
                </div>
            </abstract>
        </profileDesc>
    </teiHeader>
    <text xml:lang="en">
        <body>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Background</head>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="1.1">Structure elucidation utilizes NMR and MS</head>
                <p>Since more than 50 years mass spectrometric techniques are utilized to identify unknown compounds. Pioneers of structure elucidation around Carl Djerassi 
                    <ref type="bibr" target="#b0">[1]</ref> or natural product researchers like Satoshi Omura 
                    <ref type="bibr" target="#b1">[2]</ref> or Victor Wray 
                    <ref type="bibr" target="#b2">[3]</ref> often used additional analytical techniques like nuclear magnetic resonance, Fourier-transform infrared spectroscopy, ultraviolet spectroscopy or crystallographic data for initial proposition of structures of natural products which were subsequently confirmed by organic synthesis. The famous Dendral project 
                    <ref type="bibr" target="#b3">[4]</ref> was one of the first concerted actions for structure elucidation approaches using computers which led to the term CASE (Computer-Assisted Structure Elucidation). Machine learning techniques (at this time called Artificial Intelligence), heuristic rules 
                    <ref type="bibr" target="#b3">[4]</ref> and other chemometrical methods were combined to investigate nuclear magnetic resonance (NMR) and mass spectrometry (MS) data in order to find the correct structure of unknown chemicals in shorter time than manual investigation of all spectral data. Although microflow-NMR 
                    <ref type="bibr" target="#b4">[5]</ref> was introduced recently using new cap-NMR probes or cryogenic probes, NMR still lacks sensitivity compared to MS. Two dimensional NMR coupling experiments need measurement times up to hours. More importantly, complex mixtures cannot be fully resolved by NMR data acquisition only. For this purpose, NMR is coupled to high pressure liquid chromatography (HPLC) to separate mixtures prior to data acquisition. Data acquired solely by HPLC-1 H-NMR are insufficient for de novo structure elucidation purposes 
                    <ref type="bibr" target="#b5">[6]</ref>. Only if separation of co-eluting compounds is complete, resulting in a high enough mass of a pure compound, NMR couplings of protons, carbons and heteronuclei can in principle be used for a full structure elucidation, even without mass spectral data 
                    <ref type="bibr" target="#b6">[7]</ref>. However, a rapid and automated annotation and structure elucidation of small molecules is still a challenge for complex mixtures. Due to its universality and sensitivity, mass spectrometry is a method of choice as starting point for identification procedures. Library search strategies using the fragmentation pattern of mass spectra of known and available compounds are well established 
                    <ref type="bibr" target="#b7">[8]</ref>. However, small molecules can not be sequenced like peptides or proteins 
                    <ref type="bibr" target="#b8">[9]</ref>; hence there is no universal approach for de-novo structure elucidation utilizing MS/MS or MS n techniques for unknown compounds or for the 30 million currently known isomeric structures that are not commercially available.
                </p>
                <p>Separation techniques like HPLC or ultrahigh pressure liquid chromatography (UPLC), capillary electrophoresis (CE) or gas chromatography (GC) are routinely coupled to mass spectrometry to separate and eventually detect and identify all components of complex matrices. Yet reaching such comprehensive aims is far from reality. For the identification of an unknown compound by mass spectrometry, first and foremost a correct elemental composition of the native chemical must be computed. We have recently published an approach how to utilize isotopic abundance patterns of mass spectra for the reduction of formula candidates 
                    <ref type="bibr" target="#b9">[10]</ref> and how public databases can be searched and compounds can be annotated by their molecular formula. We here extend this approach by establishing and implementing chemical and heuristic rules that are used as constraints for finding the correct chemical formula, and we validate this approach on a large database consisting of 432,968 molecular formulas which covered a chemical space of more than five million compounds.
                </p>
                <p>Several other programs have been suggested in the past for this purpose but none of them was validated on larger datasets like in this study. One program directly uses electron impact (EI) spectra and performs a compatibility check of the molecular formula on EI mass spectra 
                    <ref type="bibr" target="#b10">[11]</ref>. For that purpose fragmentation patterns are examined and molecular formulas are calculated for these fragments using additional constraints. Another suite of programs used a test set of 900 compounds for interpretation of low resolution mass spectra and computation of highly probable elemental compositions 
                    <ref type="bibr" target="#b11">[12]</ref>. Subsequently, a set of empirical filter functions is used, but the validity of these filters was not thoroughly investigated due to the limited size of the molecular test sets.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="1.2">Compound identification requires high resolution and high accuracy of mass and isotope ratio measurements</head>
                <p>In this paper we assume compounds to be completely resolved from co-eluting or isobaric compounds by the combination of chemical separation and high mass resolution 
                    <ref type="bibr" target="#b12">[13]</ref>. Ultrahigh mass accuracy (less than 1 ppm) and high resolving power (750,000 at m/z 400; FWHM, full width at half maximum) can be obtained with Fourier-transform ion cyclotron mass spectrometry (FT-MS) 
                    <ref type="bibr" target="#b13">[14]</ref> or by Orbitrap mass spectrometers 
                    <ref type="bibr" target="#b14">[15]</ref> (max. resolving power 100,000; FWHM). However, data acquired even by ultrahigh mass accuracy and mass resolution are insufficient for calculating unique elemental compositions without information about isotope ratios 
                    <ref type="bibr" target="#b9">[10]</ref>. Isotope ratios are measured since the very beginning of mass spectrometry 
                    <ref type="bibr" target="#b15">[16]</ref>. Natural occurring elements can be monoisotopic (F, Na, P, I) or polyisotopic (H, C, N, O, S, Cl, Br) 
                    <ref type="bibr" target="#b16">[17]</ref>. The calibrated abundance values of these elements are reported by the IUPAC 
                    <ref type="bibr" target="#b17">[18]</ref>. Using isotopic pattern generators 
                    <ref type="bibr" target="#b18">[19]</ref> one can calculate the contribution to the abundances of the M+1, M+2, M+3 isotope ions in mass spectra, where M +• or M -• reflect the molecular ion. As the number of elements increase in complex and large molecules, the computation of correct isotope ratios becomes more complicated 
                    <ref type="bibr" target="#b19">[20]</ref>. In fact, small molecule formulas can be calculated even from low-resolution quadrupole mass spectrometry data when isotope patterns and silylations were included as search constraints 
                    <ref type="bibr" target="#b20">[21]</ref>.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="1.3">Raw data processing for complex samples involves peak picking, mass spectral deconvolution, and determination of molecular ions by adduct detection</head>
                <p>Even techniques with high peak capacities such as GCxGC/MS (comprehensive GC) or UPLC/MS will lead to partially co-eluting peaks for complex mixtures. Moreover, low abundant compounds may not be apparent by visual inspection of chromatograms. Detection of single components from complex chromatograms is therefore performed by peak picking and mathematical deconvolution routines. The development of the freely available AMDIS program 
                    <ref type="bibr" target="#b21">[22]</ref> was a major milestone for GC/MS data analysis. The CODA algorithm 
                    <ref type="bibr" target="#b22">[23]</ref> for LC/MS data analysis is now implemented into different commercial packages. Such peak picking and mass spectrometric deconvolution routines are obligatory unless chemicals purified otherwise are directly introduced into the mass spectrometer via a probe or direct infusion.
                </p>
                <p>The determination of the molecular ion from a given mass spectrum is one of the crucial steps during mass spectral evaluation. For electron impact spectra (EI) this problem has been tackled 
                    <ref type="bibr" target="#b23">[24]</ref> and the corresponding algorithm is implemented in the NIST MS-Search Program 
                    <ref type="bibr" target="#b24">[25]</ref>. Most often, GC/MS instruments are run under EI ionization. Unfortunately, molecular ions observed in EI spectra frequently have very low abundances or are complete absent (specifically when using trimethylsilyl derivatives) which limit the use of molecular ion calculations. Instead, soft ionization techniques like chemical ionization (CI), field emission (FE), field desorption (FD) or other methods may be employed for ionizing compounds separated by GC. Resulting from soft ionization, GC/MS spectra often comprise abundant molecular ions which may be utilized for assigning molecular formulas if an accurate mass spectrometer is used. LC/MS surveys almost exclusively use soft ionization procedures (electrospray or atmospheric pressure chemical ionization), both producing adducts of molecular ions such as [M+H] + or [M+Na] + or multiple others. Obviously, the nature of the adduct formation must be determined before accurate mass data acquisitions can be used for assigning elemental compositions 
                    <ref type="bibr" target="#b25">[26]</ref>. Although the problem is well known since several years, only recently a commercial program has been released to the market 
                    <ref type="bibr" target="#b26">[27]</ref>. Yet, routine recognition of adduct formation in LC/MS has not been validated on large datasets of diverse mass spectra.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Results</head>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Developing rules for constraining formula generators 2.1 The rings-and-double-bond equivalent and the nitrogen rule are not instrumental for calculating sum formulas</head>
                <p>Atoms in chemical structures are connected by one or multiple chemical bonds. Consequently, the rings-plusdouble-bonds equivalent (RDBE) or double-bond equivalent (DBE) concept was introduced in the 1950's 
                    <ref type="bibr" target="#b27">[28,</ref>
                    <ref type="bibr" target="#b28">29]</ref>, and shortly later, the term of "degree of unsaturation" was introduced 
                    <ref type="bibr" target="#b29">[30]</ref>. RDBE values can be calculated the following formula 
                    <ref type="bibr" target="#b30">[31]</ref>:
                </p>
                <formula xml:id="formula_0">RDBE = C+Si -1/2(H+F+Cl+Br+I) + 1/2(N+P)+1 (1)</formula>
                <p>Each element symbol here represents the count of atoms of this element in the molecular formula. The elements oxygen and sulphur were not taken into account. This equation is still in use by organic chemists and mass spectrometrists, and it is frequently used in mass spectrometry software and common molecular generators. However, the equation is based on the lowest valence state for each element which therefore does not allow an exhaustive and correct calculation of the true RDBE values for a given accurate mass. So even if double bonds exist in the molecule, the formula does not count the number of double bonds correctly. Due to this known problem a more general approach was suggested to calculate the degree of unsaturation which also includes excess localized electrons 
                    <ref type="bibr" target="#b31">[32]</ref>. However, even this approach does not yield unique solutions. The elements nitrogen and phosphorous can have three or five valences, and sulphur atoms may have two, four or six valences. In organic compounds nitrogen has a valence of three. For molecules that contain these three atoms in different mixed combinations of their valence states, no single solution for RDBE can be calculated but an RDBE range would result.
                </p>
                <p>Moreover, negative RDBE numbers can not be excluded a priori, because normal valence state may be exceeded. More than 64 substances were found to have negative RDBE numbers when querying formulas in the NIST and Wiley mass spectral databases. Most of these compounds contained either chlorine or fluorine atoms together with elements N, O, S or P. For example C 12 H 36 F 6 N 6 O 2 P 4 Si 2 (CAS: 110228-63-2, RDBE = -1) is a substance with phosphorous in the valence of five. CH 2 F 10 S 2 (CAS: 117146-25-5, RDBE = -4) comprises sulphur at a valence state of six. Organic sulphates contain sulphur at a valence state of six. For example, for dimethyl sulfate an RDBE value of zero is calculated although actually two double bonds are present in the molecular structure. Due to these uncertainties, it cannot be automatically decided if the RDBE value for a specific formula is correct. Therefore, RDBE values are of rather limited use as constraint in assigning chemically possible elemental formulas. However, a helpful application of the rings-plus-double-bonds equivalent is to detect formulas with an extremely high RDBE value. For example, RDBE values may be utilized to either exclude or include fullerenes, like C 78 H 12 Cl 2 N 2 with an RDBE of 73. Most of the compounds in our test set (99.90%) were found to comprise an RDBE of less than 40.</p>
                <p>These results on assumptions and limitations of RDBE values exclude using rings-and-double-bond equivalents as constraint in calculation of molecular formulas. Instead, we have assumed all chemically possible valence values be valid for all elements under investigation, in order to allow an exhaustive calculation of elemental compositions. Consequently, the number of theoretically allowed molecular formulas is dramatically increased in the first instance, reflecting the chemical diversity of molecules that can be built from the scaffold of elements and their oxidation and valence states.</p>
                <p>The nitrogen rule states that an odd nominal molecular mass implies also an odd number of nitrogens. This rule should only be used with nominal (integer) masses. When using accurate mass measurements this rule becomes unreliable in mass ranges higher than 500 Da. A test performed with 17,000 formulas from 27-3000 Da resulted in 20% wrong assignments for the number of odd or even nitrogens. This is due to the fact that small non-nominal mass contributions from a large number of elements add up in higher mass regions. An example would be C 38 H 64 N 2 (accurate mass 548.50692 Da; integer mass 548 Da). This rule can be helpful in lower mass ranges using unit resolution mass spectrometers or during assignment of elemental compositions to small fragments.</p>
                <p>Below, we demonstrate how a combination of heuristic and chemical rules reduces the number of theoretical formulas to a small set of the most likely compositions. The development and validation for each of the seven rules is shown in the following sections.</p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="2.2">Establishing heuristic and chemical rules Rule #1 -restrictions for element numbers</head>
                <p>The restriction of element numbers is important to save computational time and disk space. If the research is aimed towards natural compounds (hence, excluding peptides) there is no reason to include chemicals with unreasonable high element counts. For developing this rule, the absolute element limits were calculated by simply dividing the mass range through the element mass (e.g. for carbon = 12 Da at 1000 Da follows 1000/12 = 83 maximum limit for a hypothetical molecule that consists exclusively of carbon. The maximum element count was further restricted in a heuristic manner by using the development set of formulas that were derived from NIST and Wiley mass spectra and DNP entries. Results are given in Table 
                    <ref type="table" target="#tab_0">1</ref>. Maximum element counts were defined for the mass ranges at &lt; 500 Da, &lt; 1000 Da, &lt; 2000 Da, &lt; 3000 Da by taking the higher value found in either of the two development databases. For example, for 47 carbon atoms the maximum hydrogen number does not exceed 150 using the most common six elements (C, H, N, S, O, P and Si) and are usually much lower. For natural products, the numbers for nitrogen, phosphor and sulphur are smaller than those of peptides. For example, in the range 960-1080 Daltons, peptides show a maximum nitrogen number of 36 but for natural small molecules, a maximum of only 30 is found.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Rule #2 -LEWIS and SENIOR check</head>
                <p>In principle, elemental formulas can be calculated from accurate mass measurements for any species, ions, radicals or neutralized (uncharged) molecules. Since mass spectrometers can only detect ions (and ion radicals), common formula calculators like CHEFOEG 
                    <ref type="bibr" target="#b32">[33]</ref> or Hires MS 
                    <ref type="bibr" target="#b33">[34]</ref> calculate all combinations of elements that result in the correct (measured) mass, disregarding advanced tests for the physical existence of chemical structures, because in gas phase chemistry of radicals and ion radicals, many uncommon and short-lived molecule species may exist (as fragments) that would not be described as stable compounds under natural conditions. Conversely, for the objective to determine the correct formula for natural products, it is reasonable to check if a molecular graph (a chemically existent species) can be built from a specific formula. Two of the fundamental deterministic chemical rules are not obeyed by common formula calculators, the LEWIS and SENIOR rules. These rules can best be tested for neutral compounds, hence ionic species detected in mass spectrometry first need to be neutralized by determining the adduct formation and correcting for it. For example, for obtaining the neutral structure from protonated compounds, a common adduct formed under positive electrospray mass spectrometry conditions, subtracting the proton mass of 1.007825 u from the accurate mass data would be required. Without determining and neutralizing the molecular ion, species that are nonexistent would be calculated by common calculators such as C 6 H 16 O 3 . Accordingly, any report on accurate mass measurements should at least detail the ion species (adducts) that were determined in order to enable post hoc validations.
                </p>
                <p>In its simplest form, the LEWIS rule demands that molecules consisting of main group elements, especially carbon, nitrogen and oxygen, share electrons in a way that all atoms have completely filled s, p-valence shells ('octet rule'). However, free radicals such as 5-hydroxy-2,2-dimethyl-1-Pyrrolidinyloxy (C 6 H 12 NO 2 ; CAS: 55482-03-6), and in fact, all nitroso compounds, would not be allowed if the LEWIS rule would be strictly enforced. The LEWIS rule marks such compounds to be odd electron molecules, and the RDBE value would be a non-integer (in this case 1.5). If such radical components need to be checked, the rule has to be disabled within the source code of our script. Furthermore, newer quantum mechanic ab-initio calculations have shown that certain hypervalent molecules do not obey the LEWIS rule 
                    <ref type="bibr" target="#b34">[35]</ref>, and therefore we have combined it with a test for the extended SENIOR rule. Senior's theorem 
                    <ref type="bibr" target="#b35">[36]</ref> requires three essential conditions for the existence of molecular graphs 
                    <ref type="bibr" target="#b36">[37]</ref>:
                </p>
                <p>i) The sum of valences or the total number of atoms having odd valences is even;</p>
                <p>ii) The sum of valences is greater than or equal to twice the maximum valence;</p>
                <p>iii) The sum of valences is greater than or equal to twice the number of atoms minus 1.</p>
                <p>The SENIOR rule is included in advanced molecular isomer generator such as the commercial MOLGEN 
                    <ref type="bibr" target="#b37">[38]</ref> or the Deterministic Structure Generator 
                    <ref type="bibr" target="#b38">[39]</ref>, which was built with the help of the free Chemistry Development Kit (CDK) 
                    <ref type="bibr" target="#b39">[40]</ref>. Both calculators have free test-versions available online. However, certain radicals such as nitroso compounds should be excluded in MOLGEN or need additional preparatory steps. More severe limitations are found that both calculators only take ground state valences into account, i.e. sulphur with two valences, phosphorous with three valences. These elements may have higher valences, and importantly, each element may have different numbers of valences in a specific, chemically allowed molecule. So far, calculators were unable to handle all combinations of mixed valences and higher valence states which would discriminate physically existent molecular formulas if directly applied or implemented into algorithms for filtering formulas by chemical rules. Consequently, the algorithm presented here tests for LEWIS and SENIOR rules by allowing maximum valence states for each element, and presence of mixed valence states for each element within molecular structures.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Rule #3 -isotopic pattern filter</head>
                <p>Compounds that were synthesized by natural precursors comprise monoisotopic and isotope masses according to the natural average abundance of stable isotope abundances which are listed for each element 
                    <ref type="bibr" target="#b17">[18]</ref>. Previously, we have shown that applying isotopic abundance patterns removes most of the wrongly assigned molecular formulas from a certain mass measurement experiment 
                    <ref type="bibr" target="#b9">[10]</ref>, and we proved that without isotope information, even a hypothetical spectrometer capable of 0.1 ppm mass accuracy could not report unique elemental compositions in the range above 185.9760 Dalton when elements C, H, N, S, O and P were included in the search list. Therefore, isotope ratio abundance was included in the algorithm as an additional orthogonal constraint, assuming high quality data acquisitions, specifically sufficient ion statistics and high signal/noise ratio for the detection of the M+1 and M+2 abundances. Mass spectrometers such as time-offlight instruments are commercially available which report isotopic abundance patterns with a very low relative error (around 2-5% relative standard deviation Figure 
                    <ref type="figure" target="#fig_0">1</ref> shows all M+1 and M+2 patterns for the formulas from the Wiley mass spectral database and a data set of calculated peptide formulas. This figure demonstrates that for a few compound classes such as brominated and chlorinated small molecules, but also for sulphur-containing peptides, the isotope pattern is a valuable tool to immediately determine the presence of such elements. For monoisotopic elements (F, Na, P, I) this rule has no impact. The relative impact of the isotopic ratio evaluations against the other rules is highlighted below.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Rule #4 -Hydrogen/Carbon element ratio check</head>
                <p>Another important constraint for restricting formulas to those that are likely to exist is including element ratios, especially the hydrogen/carbon ratio (see Figure 
                    <ref type="figure">2</ref>). In most cases the hydrogen/carbon ratio does not exceed H/ C &gt; 3 with rare exception such as in methylhydrazine (CH 6 N 2 ). Conversely, the H/C ratio is usually smaller than 2, and should not be less than 0.125 like in the case of tetracyanopyrrole (C 8 HN 5 ). Figure 
                    <ref type="figure">2</ref> demonstrates that most typical ratios are found between 2.0 &gt; H/C &gt; 0.5, for example for long chain alkanes (H/C ~ 2) or polycyclic aromatic hydrocarbons (H/C~ 0.5). Frequency distributions were found to be not Gaussian, so limit ranges could not be defined by 3σ or 4σ standard deviations which would cover 99.7% and 99.99%, resp., of all formulas in the data set. Instead, cumulative percentages were used as range limits, given as Table 
                    <ref type="table" target="#tab_3">2</ref> for examining the Wiley spectral database as development set. More than 99.7% of all formulas were included with H/C ratios between 0.2-3.1. Consequently, we call this range the 'common range'. However, a number of chemical classes fall out of this range, and we have hence enabled the user to select 'extended ranges' covering 99.99% of all formulas in this development database (H/C 0.1-6). There are extreme cases for which rules of typical H/C ratios may be overridden, e.g. for the study of fullerenes 
                    <ref type="bibr" target="#b40">[41]</ref> which have an extremely low hydrogen/carbon ratio such as in C 78 H 12 Cl 2 N 2 . The implementation of our script enables researchers to exclude certain rules if needed for specific applications.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Rule #5 -heteroatom ratio check</head>
                <p>Element ratio checks strongly reduce the number of candidate formulas. However, we found that heteroatom ratios distributions are even more skewed than H/C ratios, because many formulas comprise no heteroatom at all (such as alkanes) or very few, and rare cases exist with high ratios of heteroatoms to carbon numbers. Table 
                    <ref type="table" target="#tab_3">2</ref> lists the common, the extended and the extreme ratios for small organic compounds comprised in the Wiley mass spectral database. Rule #6 -element probability check Rule #5 only restricts unlikely high element ratios in molecular formulas, but it does not test for multiple high element counts like in the example of C 26 H 28 N 17 O 1 P 3 S 8 . This formula would pass all rules so far including the element ratio checks; however, the combination of high element ratios would still be too improbable. Therefore, an additional constraint "multiple element count" (see Table 
                    <ref type="table" target="#tab_4">3</ref>) was included. All combinations for NOPS and all triple combinations were included in this sub-rule. In order to have a sufficiently large basis for evaluating combinations of element ratios, this sub-rule was developed using the Dictionary of Natural Products and the two mass spectral libraries NIST02 and the Wiley. For element combinations of N, O, P and N, O, S a high number of formulas was found with high element ratios, and specific thresholds were defined accordingly. Both compounds would bear six TMS groups which may mask differences in mass spectral isotope ratios given the high isotope abundances of silicon. Nevertheless, the number of TMS groups can easily be deduced by calculating isotope abundances, as we have shown in earlier work 
                    <ref type="bibr" target="#b20">[21]</ref>. For TMS derivatized molecules detected in GC/MS analyses, the rules on element ratio checks and valence tests are hence best applied after TMS groups are subtracted, in a similar manner as adducts need to be first recognized and subtracted in LC/MS analyses.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Isotopic pattern of 45</head>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Rule #7 -TMS check</head>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="2.4">Combination of all rules</head>
                <p>The application of all rules together is sufficient to derive the most likely elemental formula from accurate mass and isotopic ratio mass spectral measurements. In any case, adduct ions (in LC/MS) or TMS-derivatives (in GC/MS) have to be determined 
                    <ref type="bibr" target="#b25">[26]</ref> in order to obtain the neutral Hydrogen/Carbon ratio (H/C) for 42,000 diverse molecules (containing C, H, N, S, O, P, F, Cl, Br, I, Si) taken from the Wiley mass spectral library Figure 
                    <ref type="figure">2</ref> Hydrogen/Carbon ratio (H/C) for 42,000 diverse molecules (containing C, H, N, S, O, P, F, Cl, Br, I, Si) taken from the Wiley mass spectral library.
                </p>
                <p>-0,8 -0,6 -0,4 -0,2 0,0 0,2 0,4 0,6 0,8 The rules are implemented in an automated script written in Visual Basic and C++ which can also be used to calculate and subtract 45 usual adduct ions in LC/MS applications 
                    <ref type="bibr" target="#b25">[26]</ref>. The adduct removal must be done manually before entering any values. The script performs all the filtering in an automatic mode, triggered by the user. If formulas are not obeying the rules, they are marked with "NO", whereas allowed molecular formulas are marked with "YES". In addition, the isotopic pattern filter uses the experimental isotopic ratios to assign a score for each formula from 0-100 where higher numbers mean a higher probability of existence. Mass accuracies should be determined for specific conditions, since mass errors are known to be depending on ion statistics, automated versus manual runs, or direct infusion of purified compounds versus LC/MS runs of complex samples. Default values may be used as given by the instrument vendors. In addition to ranking formulas, these formulas are queried against internal target databases containing specific sets of molecular formulas.
                </p>
                <p>The highest ranked molecular formula candidates are directly linked online to the freely available Chemical Structure Lookup Service (CSLS) 
                    <ref type="bibr" target="#b41">[42]</ref> which covers more than 27 million unique structures from 80 public and commercial databases at the time of writing. The CSLS also links to PubChem 
                    <ref type="bibr" target="#b42">[43]</ref> but has the advantage of a much faster response time. The Dictionary of Natural Products and other copyrighted databases are searched inhouse only.
                </p>
                <p>We have validated the seven rules based on formula compilations downloaded from PubChem in early 2006 (432,968 formulas) and additionally we downloaded and included a peptide database of 120,000 molecular formulas 
                    <ref type="bibr" target="#b43">[44]</ref> comprising all combinations of the 20 proteinogenic amino acids for masses below 1000 Da.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="3.">Validation and exemplary application of the seven rules 3.1 Compounds in PubChem are covered by the rule constraints</head>
                <p>As stated above, rules were evolved from the Wiley mass spectral libraries and the DNP database (~ 47,000 and 31,000 unique elemental compositions, respectively and combined a total of 68,237 unique formulas). The NIST02 mass spectral database was additionally used for special test cases. The mass spectral databases were selected for rule development because mass spectrometry is usually used for molecular formula determination. For validation, we have compiled a much larger database of 432,968 unique molecular formulas that were derived from 5 million compounds from the PubChem database (version February 2006). At the time of writing the PubChem database has almost doubled to 10 million compounds. Even if such queries were possible, onlinequery times would be rather slow. We have therefore downloaded or purchased the databases for in-house use and rapid access. The PubChem database was found to well represent the known molecular space of small molecules. 27% of all elemental compositions were found </p>
                <formula xml:id="formula_1">F/C 0-1.5 0-6 &gt; 1.5 Cl/C 0-0.8 0-2 &gt; 0.8 Br/C 0-0.8 0-2 &gt; 0.8 N/C 0-1.3 0-4 &gt; 1.3 O/C 0-1.2 0-3 &gt; 1.2 P/C 0-0.3 0-2 &gt; 0.3 S/C 0-0.8 0-3 &gt; 0.8 Si/C 0-0.5 0-1 &gt; 0.5</formula>
                <p>between 400-500 Dalton (see Figure 
                    <ref type="figure" target="#fig_1">3</ref>). Out of a total of more than five million chemical structures, 99.6% of all formulas comprised less than 99 carbon or hydrogen atoms, rendering this number a reasonable cut off that we have utilized in our script implementation. Interestingly, only 2665 molecular formulas (0.6%) failed to pass the set of seven rules we have developed. Among them 1589 molecular formulas did not pass the Lewis and Senior check, either because of conversion errors, wrong formulas or they were true radical containing compounds. Most of the other failed candidates (1481) did not pass rule #6 -the HNOPS probability check -due to the fact that they did not contain any hydrogen. The following largest group (1349 candidates) did not pass rule #4, the hydrogen/carbon ratio test. An overlap analysis revealed that 21,783 molecular formulas (5%) from Wiley and DNP were not contained in the PubChem validation set. These results demonstrate the good performance of the set of rules, despite the comparatively small size of the development databases.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="3.2">The space of chemically possible formulas is reduced 13-fold by rules #4-6</head>
                <p>The next validation step aimed at assessing the ability of the seven rules to minimize the number of all molecular formulas with less than 2000 Da in mass. We have performed an exhaustive calculation of all formulas in this mass range containing the elements C, H, N, O, S and P which was just constrained by chemical consistency using the LEWIS and SENIOR checks, allowing the maximum valence state for each element. Table 
                    <ref type="table" target="#tab_5">4</ref> lists the result of this validation effort. Without any restrictions, i.e. by using the original HiRes formula generator and its count function, eight billion molecular formulas were generated in 29 hours computational time. Conversely, when using the newly developed brute force formula generator HR2 applying the element count, ratio and probability restrictions, the computational time was reduced to 455 seconds resulting in only 623 million formulas. Using the standard valence of three for nitrogen in organic compounds will slightly reduce the number to 598 million molecular formulas. This 13-fold reduction of formulas validates the use of elemental constraints, especially when novel mole-cules are to be annotated that are not included in the currently available databases. For example, from each of the most likely formulas, chemical structure generators may be utilized to evolve all structural isomers in either deterministic or stochastic manners, which may subsequently be sorted using other physicochemical constraints. Such exhaustive isomer generations have previously been employed for small molecule research and drug screening 
                    <ref type="bibr" target="#b44">[45]</ref>, and it might become a viable option for cluster computing as search tool in metabolomics. Molecular isomer generators can generate a plethora of structural isomers from one single molecular formula 
                    <ref type="bibr" target="#b45">[46]</ref>. Obviously, such structure generators can only be successfully applied if the number of input formulas is very small, at best restricted to one single elemental composition.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="3.3">Validation by simulated mass spectral data of 6,000 chemically diverse compounds</head>
                <p>We have therefore further explored the validity of the seven rules by simulating data acquisition errors that were imposed on subsets of compounds from four important application databases: the Dictionary of Natural Products, the open access DrugBank database 
                    <ref type="bibr" target="#b46">[47]</ref>, the Toxic Substances Control Act database (TSCA) and compounds from the NIST and Wiley mass spectral libraries. Compound subsets were selected randomly except for the mass spectral library entries which were chosen based on the constraint that formulas were absent from the PubChem, DNP or the peptide libraries. For each database subset, compounds were selected in a way that preserved the original distribution of isotope ratios and mass ranges. For all selected compounds, mass spectral measurements were simulated at ± 3 ppm mass accuracy and with ± 5% isotopic ratio errors. Such performance values should easily be achieved by time-of-flight mass spectrometers. These data were imposed by assumed random errors reflecting mass spectrometric data acquisition, using the normal cumulative distribution in order to introduce noise into the selected datasets.
                </p>
                <p>For each of these targets a ranking was performed applying the set of seven rules, and error rates were determined. Statistics were based on the mass distribution of each of the target libraries. Most of the formulas were found in the range between 300-600 Da (see Figure 
                    <ref type="figure">4a</ref>), and the effect of imposing assumed data acquisition errors is given in Figure 
                    <ref type="figure">4b</ref> and
                    <ref type="figure">4c</ref>. Table 
                    <ref type="table" target="#tab_7">5</ref> details the result of this validation experiment. It was found that when applying the set of seven rules and querying the correct target database, the correct molecular formula was ranked at the top of the list of potential other formulas in almost all cases (98-99%).
                </p>
                <p>If the more general (and much larger) PubChem database was queried, still the correct chemical formula would be retrieved as top candidate in 84-90% of the test cases, and only in 8-10% of the cases, a wrong formula was ranked highest (either due to higher ranking of another PubChem compound or due to absence of the correct formula in PubChem). The residual 2-5% of the cases represents true negatives, i.e. no PubChem formula was retrieved to fit the data because the input formula from the target databases DrugBank, DNP or TSCA were indeed absent in PubChem. Even without using any query of a formula data base, the correct input formula was ranked among the top three candidates in about 80% of the cases by the scoring function. In addition, we have deliberately selected 1200 formulas from the Wiley and NIST mass spectral databases that were absent in PubChem. These truly 'unknown compounds' would be ranked mostly among the top three hits using the set of seven rules alone; however, when querying the PubChem database, a high number of false positive formula annotations would result.</p>
                <p>This result emphasizes that our algorithm correctly annotates formula if these are present in small molecule databases, but such annotations should not be confused with unambiguous identifications. Instead, genuine compound identifications require additional information such as ion fragmentations 
                    <ref type="bibr" target="#b47">[48]</ref> or verifications by pure reference compounds. We have further investigated this data set of 6,000 target formula on the mass dependence No of obs of the number of generated formula (figure 
                    <ref type="figure" target="#fig_4">5</ref>) and the number of correct top hits (figure 
                    <ref type="figure">6</ref>), still assuming a 3 ppm error in mass accuracy and 5% isotope ratio error. Figure 
                    <ref type="figure" target="#fig_4">5</ref> demonstrates the constraining power of the seven rules at this level of mass spectrometric accuracy. The wellknown explosion of chemically possible formulas at higher mass ranges is restricted by around 80% even at 2,000 Da. However, the sole use of the seven rules does not generate unique elemental formulas. Up to about 800 Da, the scoring function alone is sufficient to rank the correct formula at the top without use of database queries with an accuracy of 80%. When querying the large PubChem database, the correct formula is ranked top with an accuracy of about 88% even at extended mass ranges, and when the (smaller) target libraries are applied, the correct formula was retrieved as top hit with a 98% rate even at high masses.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head n="3.4">Example applications of the seven rules</head>
                <p>We exemplify a worst case scenario for molecular formula determination from (theoretical) accurate mass spectrometry data: to annotate the pharmaceutical drug Cangrelor comprising eight different elements (C 17 H 25 Cl 2 F 3 N 5 O 12 P 3 S 2 ; CAS: 163706-06-7; 774.94831 Da). Even within an error of +/-0.1 ppm mass accuracy more than 449 elemental compositions are possible. More realistic data acquisition errors are, in fact, in the range of 1 ppm even with advanced mass spectrometers. For Cangrelor, 1 ppm mass accuracy would result in 4,465 molecular formulas to be generated by HR2 in 60 seconds. The isotope ratio rule alone would exclude 4,330 elemental compositions if a 5% isotope accuracy could be assumed, marked by a red box in Figure 
                    <ref type="figure" target="#fig_5">7</ref>. A score function which matches the experimentally obtained pattern against all theoretical calculated patterns can be used to further rank sum formulas. If an accuracy of 2% relative standard deviation is assumed, only 25 formulas are left when applying all seven rules. The correct formula is the only remaining elemental composition if this rank is queried against the target drug data base (but it was not present in PubChem at the time of search). In other cases, investigation of tandem mass spectra would need to be included as further constraint.
                </p>
                <p>Next, we have taken actual experimental results to validate the approaches using known compounds. First, GC-timeof-flight MS measurement data were taken for which a mass of 615.324 was obtained for the [M+H] + ion of the sugar alcohol sorbitol under chemical ionization 
                    <ref type="bibr" target="#b48">[49]</ref>. The neutralized molecule would thus have an adjusted mass of 614.316 which results in 696 elemental compositions if 5 ppm mass accuracy is assumed and the elements C, H, N, O, S, P and Si are considered, based on calculation with the MWTWIN smart hydrogen option and no   restriction on element counts. Even if time-of-flight instruments would be improved to empower 1 ppm accurate mass acquisitions, still 148 formulas would be obtained. For this example, the impact of each of the seven rules was investigated, and results are given in Table 
                    <ref type="table" target="#tab_8">6</ref>. Isotopic pattern were calculated with a modified Mercury6 version. None of the seven rules alone was efficiently removing wrong elemental compositions but altogether, the set of rules efficiently discarded more than 98% of wrong or unlikely formulas. Among the rules, still rule #3 testing isotope ratios was most efficient, but rule #2, the Senior and Lewis check and rule #7, the TMS check, also proved to be very powerful by alone rejecting 60% and 62%, respectively. Finally the resulting ten formulas were sorted according to their score matching the experimental to calculated isotopic patterns, and the correct formula for Sorbitol was ranked as top candidate.
                </p>
                <p>In The last experiment to test the applicability of the seven rules aimed at low resolution mass spectra. With only 5% isotope ratio accuracy but even worse mass accuracy (&gt; 100 ppm) we determined mass spectra for the natural product solanine (PubChem CID 6326056, C 45 H 73 NO 15 ,868.059 Da) using a regular linear ion trap mass spectrometer, which resulted in a measured mass accuracy of 46 ppm; however, calculations were performed at the 100 ppm mass accuracy level. It is notable that the mass accuracy is still better than unit-mass resolution one would expect from an ion trap instrument. Solanine isotope experimental errors were 0.31% (M+1) and 0.08% % (M+1). The program HR2 calculated 7692 possible formulas in three seconds from the neutralized mass spectral data. The seven rules implemented in our Excel script reduced these formulas to abundant 1396 possible candidate compositions assuming a 5% error for isotopic abundances, but after querying PubChem, only twelve hits remained, with the correct formula being ranked top. On a Dual-Opteron PC (2.8 GHz) all steps together were performed in 50 seconds which is an acceptable time for such computations in practice. When testing the DNP library, only two hits were retained, again ranking solanine first. For this example, the set of seven rules removed more than 99.99% of the false formula candidates when combined with PubChem and DNP checks and resulted in the correct compound, despite using low accurate mass data.</p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Discussion</head>
                <p>The seven rules have generally been developed based on a high cumulative percentage range and this range has ensured that very few existing formulas are rejected as demonstrated by the PubChem validation example. However, our element probability rules have some bias against low mass formulas at the common range (such as methane, CH 4 ) for which the rules are too strict, and on the other hand, certain unreasonable formulas like C 23 H 6 O 3 (which would consist of a very high number of cumulated carbon-carbon double bonds) are allowed by the script.</p>
                <p>Such senseless formulas need to be sorted out in subsequent steps by scoring the measured isotope ratios or by querying small molecule databases. Developing rules for element ratio checks (rule#4-6) were biased by the development database itself: the Wiley mass spectral database itself was to be unequally distributed. It comprised compounds in the range of 100 Da -700 Da with a maximum at around 400Da. Hence, more specialized databases might be useful to improve element ratio limits if needed for special applications. For example, the MDL Drug Data Report (DDR) database might be better suited for generating rules for studies involving pharmaceutical drugs. Nevertheless, even the rules developed on the basis of the Wiley and DNP databases turned out to be instrumental as demonstrated by the examination of completely independent PubChem database and specialized examples.</p>
                <p>Mass dependence of calculated, chemically possible formulas derived from 1,200 randomly selected DNP molecules, imposed with simulated 3 ppm mass accuracy ± 5% isotope ratio measurement errors </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Seven Rules</head>
                <p>Any positive annotation through database queries must be regarded as preliminary hypothesis and not as ultimate identification. Even if only one substance is retrieved, data might refer to a potential novel compound, since accurate mass and isotope data alone are too weak to positively confirm an individual compound. Instead, further constraints can be added in order to rank formulas according to probability of correct annotations. For example, information on the taxonomy of the species under study may be used. Solanine is a defence compound in potato tuber peels (Solanum tuberosum), which would specify the annotation not only to a formula but even to a single chemical compound. The same mass spectral data would lead to an antibiotic tylosin derivate if the sample was derived from Streptomyces thermotolerans. Hence, it is useful to utilize background meta-data and additional unrelated (orthog-onal) information such as mass spectral fragmentations, volatility or lipophilicity to constrain formulas and rank probabilities for individual compounds. It will further be important to acquire data on a high numbers of pure compounds in order to assess confidence intervals for mass accuracies and isotope errors for specific mass spectrometers, which may then serve as input for lowering the 3 ppm error of mass accuracy and 5% isotope errors that we have taken for calculations in this study. Any such limits will also be dependent on ion statistics, hence the abundance of signals.</p>
                <p>The seven rules are currently implemented as an automated script within the EXCEL program, which was particularly useful during development. However, several external programs (MWTWIN, HR2, batch files) had to be Effect of ranking the output formulas of the 2,400 randomly selected DrugBank molecules, imposed with simulated ± 3 ppm mass accuracy ± 5% isotope ratio measurement errors Figure 
                    <ref type="figure">6</ref> Effect of ranking the output formulas of the 2,400 randomly selected DrugBank molecules, imposed with simulated ± 3 ppm mass accuracy ± 5% isotope ratio measurement errors. Mass dependence is shown for no database query (red graph, correct formula found in the top three hits), PubChem database query (blue graph, correct formula ranked top) or querying the DrugBank database (green graph, correct formula ranked top).   column which is insufficient for mass ranges larger than 2,000 Da when up to several hundred thousand formulas need to be evaluated. The implemented batch function allows an easy check for several thousand single accurate masses from single chromatograms or mass spectral infusion data, if their relative isotopic abundances are included. The bottleneck for more accelerated computations is checking formulas via comparisons of strings. Single compiled files (in C++ or JAVA) could speed up calculations using a binary representation of the molecular formula 
                    <ref type="bibr" target="#b49">[50]</ref> or other faster database search techniques. Nevertheless, our current formula search implementation is already fast enough for checking 100,000 formulas per second using a binary tree search. The internal molecular formula database is needed, because a direct online check of thousands of formulas would require a substantial amount of time if the service is not optimized for such requests. The directly linked Chemical Structure Lookup Service (CSLS) 
                    <ref type="bibr" target="#b50">[51]</ref> has the advantage of covering a large space of constitutional isomers 
                    <ref type="bibr">(27 millions)</ref> and links also to all free and most commercial structure databases which are currently not covered in PubChem. For comparison, the proprietary Chemical Abstracts Service (CAS) currently has 30 million organic and inorganic substances.
                </p>
                <p>We have largely improved the open-source brute-force formula generator HR2 to empower an evaluation speed of 70 million formulas per second. Furthermore, HR2 could easily be linked to open source high speed algorithms for the calculation of isotopic mass and abundance patterns, such as those found in reference 
                    <ref type="bibr" target="#b19">[20]</ref>.
                </p>
                <p>There is a tremendous amount of information on small molecules. However, despite the rapid growth of PubChem, most data were inaccessible for the research presented here because such information is traditionally published in copyrighted (print) journals. So far, this wealth of data is only accumulated in databases by commercial providers such as the Chemical Abstract Service or MDL (Reed-Elsevier, Beilstein) due to the associated high costs of database maintenance and curation. Our approach might have been even more fruitful if molecules, their molecular formulas, molecular properties, spectral data 
                    <ref type="bibr" target="#b51">[52]</ref>, toxicity data 
                    <ref type="bibr" target="#b52">[53]</ref>, taxonomy of investigated species were freely accessible as meta-information which cold be harvested by software robots 
                    <ref type="bibr" target="#b53">[54,</ref>
                    <ref type="bibr" target="#b54">55]</ref> without infringing journal copyrights. Techniques for storing and handling such data are well known since several years and used in the Enhanced open NCI Database Browser 
                    <ref type="bibr" target="#b55">[56]</ref> and other open-access services. The development of rules for generation of formulas as well as validation efforts would have been even more successful if there were open-access databases of molecular information 
                    <ref type="bibr" target="#b56">[57]</ref> using the InChI 
                    <ref type="bibr" target="#b57">[58]</ref> code.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Conclusion</head>
                <p>Development and application of the seven rules has demonstrated that mass spectra are most suitable with a low error for isotopic ratios (1-5%), sufficient resolution (R = 5,000 at m/z 400) and mass accuracy between 1-5 ppm.</p>
                <p>In fact, mass accuracy was found less important than correct isotope ratio measurements. The most severe remaining bottleneck is validating the initial raw data processing (chromatography peak picking and mass spectral deconvolution) and subsequent determination of adducts to determine neutralized molecular masses. Several algorithms have already been proposed for peak finding, however, further advances on automatic adduct detection must be accomplished 
                    <ref type="bibr" target="#b26">[27]</ref> in order to cope with the high number of components in complex chromatograms.
                </p>
                <p>The set of seven rules have been shown to correctly annotate accurate mass spectra to elemental compositions for compounds consisting of the elements C, H, N, S, O, P, F, Cl and Br up to 2000 Da, if results are ranked by queries against databases of known molecular formulas. When specialized target libraries are used (e.g. for drugs, metabolites or toxicants), the correct identification rate can be as high as 98%. For novel formulas that are not included in these libraries, the correct elemental composition will be among the top three matches at a probability of 65%. As a rule of thumb, the ranking function alone works well up to 500 Dalton, but at higher masses a small molecule library is needed for correct annotation. Additionally, the seven rules successfully restricted the molecular formula space (less than 2000 Da consisting of the elements C, H, N, S, O and P) from 8 billions down to 623 million formulas. Such a restriction is important for the subsequent database search of corresponding structural isomers 
                    <ref type="bibr" target="#b45">[46]</ref>. Specifically, this is the first algorithm that calculates formulas with maximal or mixed valence states of elements such as sulphur or phosphorous. The software scripts and programs, source code and all supplement development data are freely available from the Fiehnlab projects site 
                    <ref type="bibr" target="#b58">[59]</ref>.
                </p>
            </div>
            <div
                xmlns="http://www.tei-c.org/ns/1.0">
                <head>Methods</head>
                <p>Molecular formulas for the development of the seven rules were taken from the Wiley and NIST02 mass spectral database and the Dictionary of Natural Products. Roughly 47,000 formulas were extracted using the NIST-MS-Search program 
                    <ref type="bibr" target="#b24">[25]</ref>  The EXCEL workbook provides a sheet for manual adduct removal containing 47 adducts for positive and negative ion mode. For high mass accuracy calculations also the mass of the electron has to be taken into account. All calculations require the accurate mass of the neutral form of molecule and the relative isotopic abundances which are normalized to 100%. The core EXCEL script may be used in two ways: (1) for testing the validity of input formulas in the 'controller' sheet by calculating RDBEs, accurate masses, isotopic distributions, element ratios and element probability ratios, Senior and Lewis rules and reporting the result of these checks for each of the formulas by YES/NO outputs or (2) in automated batch mode by entering measured accurate masses and isotopic abundance errors which are then checked and reported by the controller tool. Isotopic abundances must be always entered as relative abundances, normalized to 100% for the highest M+n. Using the experimental isotope ratio data the score-function ranks the results between 0 (no match) to 100 (complete match). This score function adds the differences between the computed and experimental target intensities for each of the M+1, M+2 and M+3 peaks and matches the sum of these differences against the target intensities. The formula generation is done by calling HR2 in an external process. Subsequently, all molecular formulas that are valid within a given isotopic abundance error are checked against an internal database. This internal table contains 432,968 molecular formulas from the PubChem database, including most of the commercially available chemicals and many natural products and covered more than 5 million unique compounds at the time of download. Additionally 120,000 molecular formulas comprising all combinations of the 20 proteinogenic amino acids for masses below 1000 Da and a database of small molecules were downloaded from source 
                    <ref type="bibr" target="#b43">[44]</ref> and included into the program. User databases or extended newer databases can be very easily updated on demand.
                </p>
                <p>For linking the ranked molecular formulas to structure databases we currently implemented a web reference to the Chemical Structure Lookup Service (CSLS) 
                    <ref type="bibr" target="#b41">[42]</ref> developed by the Computer Aided Molecular Design (CADD) Group at the National Cancer Institute (NCI) and Chem-Navigator.com, Inc, which covers more than 27 million unique structures from 80 databases. Such an approach is possible using SOAP XML 
                    <ref type="bibr" target="#b66">[69]</ref> or ENTREZ 
                    <ref type="bibr" target="#b67">[70]</ref> from Pubchem. Other special databases like the Dictionary of Natural Products can be accessed in-house via web services using ChemAxon's JChem or Instant-JChem 
                    <ref type="bibr" target="#b68">[71]</ref>.
                </p>
                <p>For the brute-force calculation of all molecular formulas in the range up to 2000 Da, the program HiRes MS version "20050617" 
                    <ref type="bibr" target="#b33">[34]</ref> was downloaded and enhanced to HR2. ; MW = 867.49799) was prepared and injected in positive mode with a gas pressure of 0.3 psi and a voltage of 1.6 V by the NanoMate injection system. For each infusion nanoelectrospray mass spectrum, ten mass spectra were averaged by the XCalibur software and transferred to an EXCEL sheet. For calculating adduct ion masses 
                    <ref type="bibr" target="#b25">[26]</ref> the ESI-MS adduct calculator was downloaded from 
                    <ref type="bibr" target="#b69">[73]</ref>. In all cases an abundant [M+H] + adduct ion was detected and the neutralized molecule was used for calculations at a 2 ppm mass accuracy level and for solanine at the 100 ppm level (running the LTQ without FT option) using the program HR2 after conversion from ppm to mmu mass tolerances. For the measured mass of 867.538204 Da for solanine, 100 ppm tolerance refers to 86.75 millimass units. Match tables using the seven rules were prepared assuming a 5% error for isotopic ratio measurements.
                </p>
                <p>All transformations and calculations were performed under Windows XP on a MonarchComputer Dual-Opteron 254 (2.8 GHz, 2.8 GByte RAM), equipped with an Areca ARC-1120 Raid-5 array. This equipment enabled hard disk burst read-write transfer rates of more than 500 MByte/s. An additional RamDisk (QSoft Ramdisk Enterprise) was used for file based operations allowing burst read-write rates of 1000 MByte/s.</p>
            </div>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0">
                <head>Figure 1</head>
                <label>1</label>
                <figDesc>Isotopic pattern of 45.000 compound formulas from the Wiley mass spectral database and 60.000 peptides formulas in the small molecule space &lt; 1000 Dalton. M+1 and M+2 are given as relative abundances in [%] and are normalized to 100% of the highest isotope abundance in the molecular formula. with sulfur pattern S 1 -S 9</figDesc>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1">
                <head>Frequency distribution for the 3</head>
                <label>3</label>
                <figDesc>molecular masses of all elemental compositions downloaded from the PubChem database (2006) covering more than 5 million single compounds Figure Frequency distribution for the molecular masses of all elemental compositions downloaded from the PubChem database (2006) covering more than 5 million single compounds.</figDesc>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2">
                <head>Frequency distribution for 1 ,</head>
                <label>1</label>
                <figDesc>200 randomly selected molecules downloaded from the Dictionary of Natural Products at &lt; 2000 Da and comprising C, H, N, S, O, P, F, Cl and Br Figure 4 Frequency distribution for 1,200 randomly selected molecules downloaded from the Dictionary of Natural Products at &lt; 2000 Da and comprising C, H, N, S, O, P, F, Cl and Br. Left panel, 4a: mass distribution. Middle panel, 4b: simulated measured masses at 3 ppm mass accuracy. Right panel, 4c: simulated measured isotope ratios at ± 5% accuracy.</figDesc>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4">
                <head>Figure 5</head>
                <label>5</label>
                <figDesc>Mass dependence of calculated, chemically possible formulas derived from 1,200 randomly selected DNP molecules, imposed with simulated 3 ppm mass accuracy ± 5% isotope ratio measurement errors. Red graph: number of calculated formulas with common molecular generators. Green graph: number of formulas constrained by the seven rules. Outliers around 600 Dalton were found to be halogen containing compounds.</figDesc>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5">
                <head>7</head>
                <label>7</label>
                <figDesc>+ Target Library query • 7 rules + PubChem query • 7 rules w/o database query embedded causing partial redundancies which could have been avoided if programmed in a single JAVA or C++ application. In addition, EXCEL 2003 or EXCEL XP are incapable of handling more than 65,000 values in one Relative isotopic abundances of the M+1 and M+2 peak for all elemental compositions that would fit a measured mass of 774 Figure Relative isotopic abundances of the M+1 and M+2 peak for all elemental compositions that would fit a measured mass of 774.94831 Da (Cangrelor), determined at 1 ppm mass accuracy (values exceeding 100% are removed in graphics). Most formulas can be discarded if isotope ratios are measured with an accuracy of ± 5% and used as search constraint (red box).</figDesc>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0">
                <head>Table 1 : Restrictions for number of elements during formula generation for small molecules based on examination of the DNP and Wiley mass spectral databases. For each element, the higher count was taken for denominating the element restriction rule #1 Mass Range [Da] Library C max H max N max O max P max S max F max Cl max Br max Si max</head>
                <label>1</label>
                <figDesc></figDesc>
                <table>
                    <row>
                        <cell>&lt; 5 0 0</cell>
                        <cell>D N P</cell>
                        <cell>2 9</cell>
                        <cell>7 2</cell>
                        <cell>1 0</cell>
                        <cell>1 8</cell>
                        <cell>4</cell>
                        <cell>7</cell>
                        <cell>1 5</cell>
                        <cell>8</cell>
                        <cell>5</cell>
                    </row>
                    <row>
                        <cell></cell>
                        <cell>W i l e y</cell>
                        <cell>3 9</cell>
                        <cell>7 2</cell>
                        <cell>2 0</cell>
                        <cell>2 0</cell>
                        <cell>9</cell>
                        <cell>1 0</cell>
                        <cell>1 6</cell>
                        <cell>1 0</cell>
                        <cell>4</cell>
                        <cell>8</cell>
                    </row>
                    <row>
                        <cell>&lt; 1000</cell>
                        <cell>DNP</cell>
                        <cell>66</cell>
                        <cell>126</cell>
                        <cell>25</cell>
                        <cell>27</cell>
                        <cell>6</cell>
                        <cell>8</cell>
                        <cell>16</cell>
                        <cell>11</cell>
                        <cell>8</cell>
                    </row>
                    <row>
                        <cell></cell>
                        <cell>Wiley</cell>
                        <cell>78</cell>
                        <cell>126</cell>
                        <cell>20</cell>
                        <cell>27</cell>
                        <cell>9</cell>
                        <cell>14</cell>
                        <cell>34</cell>
                        <cell>12</cell>
                        <cell>8</cell>
                        <cell>14</cell>
                    </row>
                    <row>
                        <cell>&lt; 2000</cell>
                        <cell>DNP</cell>
                        <cell>115</cell>
                        <cell>236</cell>
                        <cell>32</cell>
                        <cell>63</cell>
                        <cell>6</cell>
                        <cell>8</cell>
                        <cell>16</cell>
                        <cell>11</cell>
                        <cell>8</cell>
                    </row>
                    <row>
                        <cell></cell>
                        <cell>Wiley</cell>
                        <cell>156</cell>
                        <cell>180</cell>
                        <cell>20</cell>
                        <cell>40</cell>
                        <cell>9</cell>
                        <cell>14</cell>
                        <cell>48</cell>
                        <cell>12</cell>
                        <cell>10</cell>
                        <cell>15</cell>
                    </row>
                    <row>
                        <cell>&lt; 3000</cell>
                        <cell>DNP</cell>
                        <cell>162</cell>
                        <cell>208</cell>
                        <cell>48</cell>
                        <cell>78</cell>
                        <cell>6</cell>
                        <cell>9</cell>
                        <cell>16</cell>
                        <cell>11</cell>
                        <cell>8</cell>
                    </row>
                </table>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1">
                <head></head>
                <label></label>
                <figDesc>For example, accurate masses for C 20 H 58 N 6 O 4 Si 6 and C 24 H 62 O 6 Si 6 differ only by 4 ppm, but after subtraction of TMS groups, the residual (native) molecule C 6 H 14 O 6 is much more likely according to rules #4-6 than C 2 H 10 N 6 O 4 .</figDesc>
                <table />
                <note>Analysis of small molecules is often performed by GC/MS, frequently requiring chemical derivatization of the original molecules to enhance volatility, stability or sensitivity of detection. For applications in metabolomics or clinical chemistry, a commonly used derivatization step involves trimethylsilylation by MSTFA (NMethyltrimethylsilyltrifluoroacetamide; CAS: 24589-78-4) which exchanges acidic protons against TMS (trimethylsilyl) groups. If ionization conditions and molecular structures allow for the observation of molecular ions, TMS groups (C 3 H 8 Si) have to be subtracted for calculating the underivatized molecule.</note>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3">
                <head>Table 2 : Common element ratios obtained from 45.000 formulas comprising the Wiley mass spectral database for the mass range 30 Da -1500 Da Element ratios Common range (covering 99.7%) Extended range (covering 99.99%) Extreme range (beyond 99.99%)</head>
                <label>2</label>
                <figDesc></figDesc>
                <table>
                    <row>
                        <cell>H/C</cell>
                        <cell>0.2-3.1</cell>
                        <cell>0.1-6</cell>
                        <cell>&lt; 0.1 and 6-9</cell>
                    </row>
                </table>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4">
                <head>Table 3 : Multiple element count restriction for compounds &lt; 2000 Da, based on the examination of the Beilstein database and the Dictionary of Natural Products</head>
                <label>3</label>
                <figDesc></figDesc>
                <table>
                    <row>
                        <cell>Element counts</cell>
                        <cell>Heuristic Rule</cell>
                        <cell>DB examples for maximum values</cell>
                    </row>
                    <row>
                        <cell>NOPS all &gt; 1</cell>
                        <cell>N&lt; 10, O &lt; 20, P &lt; 4, S &lt; 3</cell>
                        <cell>C 15 H 34 N 9 O 8 PS, C 22 H 44 N 4 O 14 P 2 S 2 , C 24 H 38 N 7 O 19 P 3 S</cell>
                    </row>
                    <row>
                        <cell>NOP all &gt; 3</cell>
                        <cell>N &lt; 11, O &lt; 22, P &lt; 6</cell>
                        <cell>C 20 H 28 N 10 O 21 P 4 , C 10 H 18 N 5 O 20 P 5</cell>
                    </row>
                    <row>
                        <cell>OPS all &gt; 1</cell>
                        <cell>O &lt; 14, P &lt; 3, S &lt; 3</cell>
                        <cell>C 22 H 44 N 4 O 14 P 2 S 2 , C 16 H 36 N 4 O 4 P 2 S 2</cell>
                    </row>
                    <row>
                        <cell>PSN all &gt; 1</cell>
                        <cell>P &lt; 3, S &lt; 3, N &lt; 4</cell>
                        <cell>C 22 H 44 N 4 O 14 P 2 S 2 , C 16 H 36 N 4 O 4 P 2 S 2</cell>
                    </row>
                    <row>
                        <cell>NOS all &gt; 6</cell>
                        <cell>N &lt; 19 O &lt; 14 S &lt; 8</cell>
                        <cell>C 59 H 64 N 18 O 14 S 7</cell>
                    </row>
                </table>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5">
                <head>Table 4 : Results for number of molecular formulas in ranges &lt; 500, &lt; 1000 and &lt; 2000 Da for elements CHNSOP with maximum valencies (v N = 5, v S = 6, v P = 5) and maximum element counts, last column with element count restrictions from either DNP or Wiley database</head>
                <label>4</label>
                <figDesc></figDesc>
                <table>
                    <row>
                        <cell>Mass range (u)</cell>
                        <cell>Maximum number of</cell>
                        <cell>With element ratio check</cell>
                        <cell>With probability check</cell>
                        <cell>With probability check +</cell>
                    </row>
                    <row>
                        <cell></cell>
                        <cell>molecular formulas</cell>
                        <cell></cell>
                        <cell></cell>
                        <cell>element count restriction</cell>
                    </row>
                    <row>
                        <cell>500</cell>
                        <cell>2,707,540</cell>
                        <cell>1,772,483</cell>
                        <cell>729,617</cell>
                        <cell>724,270</cell>
                    </row>
                    <row>
                        <cell>1000</cell>
                        <cell>139,735,355</cell>
                        <cell>87,888,303</cell>
                        <cell>32,555,050</cell>
                        <cell>30,077,741</cell>
                    </row>
                    <row>
                        <cell>2000</cell>
                        <cell>7,995,776,805</cell>
                        <cell>4,926,973,096</cell>
                        <cell>1,170,870,061</cell>
                        <cell>623,270,049</cell>
                    </row>
                </table>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7">
                <head>Table 5 : Validation of the seven rules using random sub-sampled test sets from specialized databases. Performance is given assuming mass spectrometry errors of ± 5% isotope abundance error and ± 3 ppm mass accuracy and calculating element combinations of C, H, N, S, O, P, F, Cl and Br Test set and Source Number of random formulas Mass range [Da] target DB top hit [%] PubChem top hit [%] PubChem false top hit [%] no DB query top 3 hits [%]</head>
                <label>5</label>
                <figDesc></figDesc>
                <table>
                    <row>
                        <cell>Pharmaceuticals</cell>
                        <cell>2400</cell>
                        <cell>30-1093</cell>
                        <cell>99</cell>
                        <cell>90</cell>
                        <cell>8</cell>
                        <cell>78</cell>
                    </row>
                    <row>
                        <cell>(DrugBank)</cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                    </row>
                    <row>
                        <cell>Natural Products</cell>
                        <cell>1200</cell>
                        <cell>92-2020</cell>
                        <cell>99</cell>
                        <cell>84</cell>
                        <cell>10</cell>
                        <cell>81</cell>
                    </row>
                    <row>
                        <cell>(DNP)</cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                    </row>
                    <row>
                        <cell>Toxic Chemicals</cell>
                        <cell>1200</cell>
                        <cell>56-2170</cell>
                        <cell>98</cell>
                        <cell>87</cell>
                        <cell>8</cell>
                        <cell>78</cell>
                    </row>
                    <row>
                        <cell>(TSCA)</cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                    </row>
                    <row>
                        <cell>Unknowns taken from</cell>
                        <cell>1200</cell>
                        <cell>150-1536</cell>
                        <cell>-</cell>
                        <cell>-</cell>
                        <cell>78</cell>
                        <cell>65</cell>
                    </row>
                    <row>
                        <cell>Wiley+NIST</cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                        <cell></cell>
                    </row>
                </table>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8">
                <head>Table 6 : Single performance of each rule of the seven rules from a total of 696 formulas comprising the elements CHNSOP and Si, calculated from GC-TOF data of sorbitol TMS 6 Rules for molecular formula filtering Single application of each rule</head>
                <label>6</label>
                <figDesc></figDesc>
                <table>
                    <row>
                        <cell>1) heuristic restrictions for number of elements</cell>
                        <cell>not used (smart H option instead)</cell>
                    </row>
                    <row>
                        <cell>2) perform LEWIS and SENIOR check</cell>
                        <cell>can remove 420 candidates</cell>
                    </row>
                    <row>
                        <cell>3) isotopic pattern filter at 5% error</cell>
                        <cell>can remove 668 candidates</cell>
                    </row>
                    <row>
                        <cell>isotopic pattern filter at 10% error</cell>
                        <cell>can remove 632 candidates</cell>
                    </row>
                    <row>
                        <cell>isotopic pattern filter at 20% error</cell>
                        <cell>can remove 462 candidates</cell>
                    </row>
                    <row>
                        <cell>4) H/C ratio check (hydrogen/carbon ratio)</cell>
                        <cell>can remove 56 candidates</cell>
                    </row>
                    <row>
                        <cell>5) NOPS ratio check (N, O, P, S/C ratios)</cell>
                        <cell>can remove 51 candidates</cell>
                    </row>
                    <row>
                        <cell>6) heuristic HNOPS probability check</cell>
                        <cell>can remove 180 candidates</cell>
                    </row>
                    <row>
                        <cell>7) TMS check</cell>
                        <cell>can remove 432 candidates</cell>
                    </row>
                    <row>
                        <cell></cell>
                        <cell>combined 10 candidates left</cell>
                    </row>
                </table>
            </figure>
            <figure
                xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_10">
                <head></head>
                <label></label>
                <figDesc>The freely available Microsoft Visual C++ 2005 Express compiler [72] was used for program development. The modified HR2 version can be used to either calculate molecular formulas of an exact mass at a certain mass accuracy (ppm) or it can be used to calculate all formulas in a given mass range. Additionally a faster counting only version can be used to calculate the possible numbers of formula candidates. This is helpful because the output of large formula ranges can result in file sizes of several giga-bytes. For calculating elemental compositions the maximum valence values for all elements were used. Element ratio check and element probability check were implemented in HR2. Our current improved version of the brute force formula generator HR2 has a performance of 50-70 million formula evaluations per seconds, depending on the dataset.Accurate GC-MS mass measurements were performed by time-of-flight mass spectrometry under chemical ionization as published previously
                    <ref type="bibr" target="#b48">[49]</ref>. Accurate mass data and accurate isotopic pattern data for Paclitaxel (Taxol) (CAS: 33069-62-4; C 47 H 51 NO 14 ; MW = 853.33094) was obtained by using infusion into a time-of-flight mass spectrometer (Bruker Daltonics MicroTOF) with electrospray ionization. The accurate measured mass [M+H] + was 854.3376 Da (-0.7 ppm error), the measured isotopic pattern were [M+1] = 56.4%, [M+2] = 16.5%, [M+3] = 2.9% with a maximum absolute error of 3.9%. Additional accurate electrospray mass measurements were acquired on a hybrid linear ion trap/Fourier transform ion cyclotron resonance mass spectrometer (ThermoElectron LTQ-FT, Waltham, MA). Pure standards were infused with an automated chip-based nanoelectrospray source (Advion Biosciences NanoMate, Ithaca, NY). At low mass accuracy and low mass resolution, the linear ion trap was operated without using the FT-MS option. The LTQ-FT was calibrated for accurate masses in positive mode using the vendor's calibration mixture. Signal intensities were optimized on each of the substances in autotune mode. The mass range was set from 500-900 Da (widescan mode) and a mass resolution of 50,000 at m/z 400 was specified. A stock solution of 50 μg/ml of Digitoxin (CAS: 71-63-6; C 41 H 64 O 13 ; MW = 764.43467) and Solanine (CAS: 51938-42-2; C 45 H 73
                    <ref type="bibr" target="#b14">NO 15</ref>
                </figDesc>
                <table />
            </figure>
            <note
                xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_0">(page number not for citation purposes)
            </note>
        </body>
        <back>
            <div type="acknowledgement">
                <div
                    xmlns="http://www.tei-c.org/ns/1.0">
                    <head>Acknowledgements</head>
                    <p>We thank Matthew Monroe (Pacific Northwest National Laboratory, Richland, WA) for making MWTWIN 
                        <ref type="bibr" target="#b70">[74]</ref> available as freeware and publishing the sources under the Apache License. We thank Jörg Hau (Nestle) for publishing the formula generator HiRes under the GNU Public License (GPL). We thank Ernst Schumacher (University of Bern) for publishing the sources of the chemical formula generator "Chefog". We thank James L. Little (Eastman Chemical Company) for the TSCA test set. We thank Alan L. Rockwood (ARUP-Lab) and Steve Van Orden (Bruker Daltonics) for providing the Mercury6 source code for accurate isotopic pattern calculation. We thank Perttu Haimi (University of Helsinki) and Alan L. Rockwood (ARUP-Lab) for releasing the programs and source codes for qmass and emass for high accuracy isotope abundance calculations under the BSD license. We thank Masanori Arita, for providing a database of peptide and metabolite formulas [75]. We thank Bruno Bienfait for publishing the SDF_toolkit under the GNU public license. We thank ChemAxon for a free academic license of their cheminformatics suite. We especially thank the PubChem developer team and contributors for providing the desperately needed open access to small molecule information. We thank Marc C. Nicklaus (CADD, NIH) and team for help regarding the CSLS lookup service. We thank Ali Kettani (Bruker Daltonics) for providing sample data from the Bruker MicroTOF. We thank Nabil Saad and Nam-In Baek for help during sample preparation and experimental measurements on the ThermoElectron LTQ-FT mass spectrometer.
                    </p>
                </div>
                <div
                    xmlns="http://www.tei-c.org/ns/1.0">
                    <head>Sponsors</head>
                    <p>: This research was supported by a grant from the National Institute of Environmental Health (NIEHS), 1R01 ES013932, granted to Oliver Fiehn. Portions of this research (MWTWIN) were supported by the NIH National Center for Research Resources (RR18522), and the W.R. Wiley Environmental Molecular Science Laboratory (PNNL). PNNL is operated by Battelle Memorial Institute for the U.S. Department of Energy under contract DE-AC06-76RLO-1830.</p>
                </div>
            </div>
            <div type="annex">
                <div
                    xmlns="http://www.tei-c.org/ns/1.0">
                    <head>Authors' contributions</head>
                    <p>Both authors contributed equally to this work and read and approved the final manuscript. </p>
                </div>
                <div
                    xmlns="http://www.tei-c.org/ns/1.0">
                    <head>Publish with</head>
                </div>
            </div>
            <div type="references">
                <listBibl>
                    <biblStruct xml:id="b0">
                        <analytic>
                            <title level="a" type="main">Sponge Sterols -Origin and Biosynthesis</title>
                            <author>
                                <persName>
                                    <forename type="first">C</forename>
                                    <surname>Djerassi</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">C</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Silva</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Accounts of Chemical Research</title>
                            <imprint>
                                <biblScope unit="volume">24</biblScope>
                                <biblScope unit="issue">12</biblScope>
                                <biblScope unit="page" from="371" to="378" />
                                <date type="published" when="1991">1991</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b1">
                        <analytic>
                            <title level="a" type="main">Trends in the Search for Bioactive Microbial Metabolites</title>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <surname>Omura</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Journal of Industrial Microbiology</title>
                            <imprint>
                                <biblScope unit="volume">10</biblScope>
                                <biblScope unit="issue">3-4</biblScope>
                                <biblScope unit="page" from="135" to="156" />
                                <date type="published" when="1992">1992</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b2">
                        <monogr>
                            <title level="m" type="main">Carbon-Carbon Coupling-Constants -Compilation of Data and a Practical Guide. Progress in Nuclear Magnetic Resonance Spectroscopy</title>
                            <author>
                                <persName>
                                    <forename type="first">V</forename>
                                    <surname>Wray</surname>
                                </persName>
                            </author>
                            <imprint>
                                <date type="published" when="1979">1979</date>
                                <biblScope unit="volume">13</biblScope>
                                <biblScope unit="page" from="177" to="256" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b3">
                        <analytic>
                            <title level="a" type="main">Applications of Artificial Intelligence for Chemical Inference .22. Automatic Rule Formation in Mass-Spectrometry by Means of Meta-Dendral Program</title>
                            <author>
                                <persName>
                                    <forename type="first">B</forename>
                                    <forename type="middle">G</forename>
                                    <surname>Buchanan</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">H</forename>
                                    <surname>Smith</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">W</forename>
                                    <forename type="middle">C</forename>
                                    <surname>White</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Gritter</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <forename type="middle">A</forename>
                                    <surname>Feigenbaum</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Lederberg</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">C</forename>
                                    <surname>Djerassi</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Am Chem Soc</title>
                            <imprint>
                                <biblScope unit="volume">98</biblScope>
                                <biblScope unit="issue">20</biblScope>
                                <biblScope unit="page" from="6168" to="6178" />
                                <date type="published" when="1976">1976</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b4">
                        <analytic>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">L</forename>
                                    <surname>Olson</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">A</forename>
                                    <surname>Norcross</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">O'</forename>
                                    <surname>Neil-Johnson</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <surname>Molitor</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <forename type="middle">F</forename>
                                    <surname>Detlefsen</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Wilson</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">G</forename>
                                    <surname>Peck</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">T</forename>
                                    <forename type="middle">L</forename>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="m">Microflow NMR: concepts and capabilities</title>
                            <imprint>
                                <date type="published" when="2004">2004</date>
                                <biblScope unit="volume">76</biblScope>
                                <biblScope unit="page" from="2966" to="2974" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b5">
                        <analytic>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">C</forename>
                                    <surname>Lindon</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">K</forename>
                                    <surname>Nicholson</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">I</forename>
                                    <forename type="middle">D</forename>
                                    <surname>Wilson</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="m">Directly coupled HPLC-NMR and HPLC-NMR-MS in pharmaceutical research and development</title>
                            <imprint>
                                <date type="published" when="2000">2000</date>
                                <biblScope unit="volume">748</biblScope>
                                <biblScope unit="page" from="233" to="258" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b6">
                        <analytic>
                            <title level="a" type="main">Structure Elucidator: a versatile expert system for molecular structure elucidation from 1D and 2D NMR data and molecular fragments</title>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <forename type="middle">E</forename>
                                    <surname>Elyashberg</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">K</forename>
                                    <forename type="middle">A</forename>
                                    <surname>Blinov</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Williams</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">G</forename>
                                    <surname>Molodtsov</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">G</forename>
                                    <forename type="middle">E</forename>
                                    <surname>Martin</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <forename type="middle">R</forename>
                                    <surname>Martirosian</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Chem Inf Comput Sci</title>
                            <imprint>
                                <biblScope unit="volume">44</biblScope>
                                <biblScope unit="issue">3</biblScope>
                                <biblScope unit="page" from="771" to="792" />
                                <date type="published" when="2004">2004</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b7">
                        <analytic>
                            <title level="a" type="main">Chemical derivatization and mass spectral libraries in metabolic profiling by GC/MS and LC/MS/MS</title>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">M</forename>
                                    <surname>Halket</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <surname>Waterman</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">M</forename>
                                    <surname>Przyborowska</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">Rkp</forename>
                                    <surname>Patel</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <forename type="middle">D</forename>
                                    <surname>Fraser</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <forename type="middle">M</forename>
                                    <surname>Bramley</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Exp Bot</title>
                            <imprint>
                                <biblScope unit="volume">56</biblScope>
                                <biblScope unit="issue">410</biblScope>
                                <biblScope unit="page" from="219" to="243" />
                                <date type="published" when="2005">2005</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b8">
                        <analytic>
                            <title level="a" type="main">Predicting molecular formulas of fragment ions with isotope patterns in tandem mass spectra</title>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">F</forename>
                                    <surname>Zhang</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">W</forename>
                                    <surname>Gao</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Cai</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">M</forename>
                                    <surname>He</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <surname>Zeng</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <forename type="middle">S</forename>
                                    <surname>Chen</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Ieee-Acm Transactions on Computational Biology and Bioinformatiocs</title>
                            <imprint>
                                <biblScope unit="volume">2</biblScope>
                                <biblScope unit="issue">3</biblScope>
                                <biblScope unit="page" from="217" to="230" />
                                <date type="published" when="2005">2005</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b9">
                        <analytic>
                            <title level="a" type="main">Metabolomic database annotations via query of elemental compositions: mass accuracy is insufficient even at less than 1 ppm</title>
                            <author>
                                <persName>
                                    <forename type="first">T</forename>
                                    <surname>Kind</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">O</forename>
                                    <surname>Fiehn</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">BMC Bioinformatics</title>
                            <imprint>
                                <biblScope unit="volume">7</biblScope>
                                <biblScope unit="page">234</biblScope>
                                <date type="published" when="2006">2006</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b10">
                        <analytic>
                            <title level="a" type="main">Automated compatibility tests of the molecular formulas or structures of organic compounds with their mass spectra</title>
                            <author>
                                <persName>
                                    <forename type="first">B</forename>
                                    <surname>Seebass</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <surname>Pretsch</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Chem Inf Comp Sci</title>
                            <imprint>
                                <biblScope unit="volume">39</biblScope>
                                <biblScope unit="issue">4</biblScope>
                                <biblScope unit="page" from="713" to="717" />
                                <date type="published" when="1999">1999</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b11">
                        <monogr>
                            <title level="m" type="main">Simple Tools for the Computer-Aided Interpretation of Mass-Spectra. Chemometr Intell Lab</title>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <surname>Heuerding</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">T</forename>
                                    <surname>Clerc</surname>
                                </persName>
                            </author>
                            <imprint>
                                <date type="published" when="1993">1993</date>
                                <biblScope unit="volume">20</biblScope>
                                <biblScope unit="page" from="57" to="69" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b12">
                        <analytic>
                            <title level="a" type="main">Debating resolution and mass accuracy</title>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <forename type="middle">P</forename>
                                    <surname>Balogh</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Lc Gc North America</title>
                            <imprint>
                                <biblScope unit="volume">22</biblScope>
                                <biblScope unit="issue">2</biblScope>
                                <biblScope unit="page">118</biblScope>
                                <date type="published" when="2004">2004</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b13">
                        <analytic>
                            <title level="a" type="main">Assigning product ions from complex MS/MS spectra: The importance of mass uncertainty and resolving power</title>
                            <author>
                                <persName>
                                    <forename type="first">L</forename>
                                    <surname>Sleno</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">A</forename>
                                    <surname>Volmer</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">G</forename>
                                    <surname>Marshall</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Journal of the American Society for Mass Spectrometry</title>
                            <imprint>
                                <biblScope unit="volume">16</biblScope>
                                <biblScope unit="issue">2</biblScope>
                                <biblScope unit="page" from="183" to="198" />
                                <date type="published" when="2005">2005</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b14">
                        <analytic>
                            <title level="a" type="main">Performance evaluation of a hybrid linear ion trap/orbitrap mass spectrometer</title>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <surname>Makarov</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <surname>Denisov</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <surname>Kholomeev</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">W</forename>
                                    <surname>Baischun</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">O</forename>
                                    <surname>Lange</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">K</forename>
                                    <surname>Strupat</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <surname>Horning</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Analytical Chemistry</title>
                            <imprint>
                                <biblScope unit="volume">78</biblScope>
                                <biblScope unit="issue">7</biblScope>
                                <biblScope unit="page" from="2113" to="2120" />
                                <date type="published" when="2006">2006</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b15">
                        <analytic>
                            <title level="a" type="main">A new method of positive ray analysis</title>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Dempster</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Physical Review</title>
                            <imprint>
                                <biblScope unit="volume">11</biblScope>
                                <biblScope unit="issue">4</biblScope>
                                <biblScope unit="page" from="316" to="325" />
                                <date type="published" when="1918">1918</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b16">
                        <analytic>
                            <title level="a" type="main">Mass spectrometry and isotopes: A century of research and discussion</title>
                            <author>
                                <persName>
                                    <forename type="first">H</forename>
                                    <surname>Budzikiewicz</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <forename type="middle">D</forename>
                                    <surname>Grigsby</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Mass Spectrometry Reviews</title>
                            <imprint>
                                <biblScope unit="volume">25</biblScope>
                                <biblScope unit="issue">1</biblScope>
                                <biblScope unit="page" from="146" to="157" />
                                <date type="published" when="2006">2006</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b17">
                        <analytic>
                            <title level="a" type="main">Atomic weights of the elements</title>
                            <author>
                                <persName>
                                    <forename type="first">De</forename>
                                    <surname>Laeter</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">R</forename>
                                    <surname>Bohlke</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">K</forename>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">De</forename>
                                    <surname>Bievre</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <surname>Hidaka</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">H</forename>
                                    <surname>Peiser</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">H</forename>
                                    <forename type="middle">S</forename>
                                    <surname>Rosman</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">Kjr</forename>
                                    <surname>Taylor</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">Pdp</forename>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Pure and Applied Chemistry</title>
                            <imprint>
                                <biblScope unit="volume">75</biblScope>
                                <biblScope unit="issue">6</biblScope>
                                <biblScope unit="page" from="683" to="800" />
                                <date type="published" when="2000">2000. 2003</date>
                            </imprint>
                        </monogr>
                        <note>Review</note>
                    </biblStruct>
                    <biblStruct xml:id="b18">
                        <analytic>
                            <title level="a" type="main">Rapid Calculation of Molecular Formulas from Mass Values</title>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Lederberg</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Chem Educ</title>
                            <imprint>
                                <biblScope unit="volume">49</biblScope>
                                <biblScope unit="issue">9</biblScope>
                                <biblScope unit="page">613</biblScope>
                                <date type="published" when="1972">1972</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b19">
                        <analytic>
                            <title level="a" type="main">Efficient calculation of accurate masses of isotopic peaks</title>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">L</forename>
                                    <surname>Rockwood</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <surname>Haimi</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Am Soc Mass Spectr</title>
                            <imprint>
                                <biblScope unit="volume">17</biblScope>
                                <biblScope unit="issue">3</biblScope>
                                <biblScope unit="page" from="415" to="419" />
                                <date type="published" when="2006">2006</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b20">
                        <analytic>
                            <title level="a" type="main">Identification of uncommon plant metabolites based on calculation of elemental compositions using gas chromatography and quadrupole mass spectrometry</title>
                            <author>
                                <persName>
                                    <forename type="first">O</forename>
                                    <surname>Fiehn</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Kopka</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <forename type="middle">N</forename>
                                    <surname>Trethewey</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">L</forename>
                                    <surname>Willmitzer</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Analytical Chemistry</title>
                            <imprint>
                                <biblScope unit="volume">72</biblScope>
                                <biblScope unit="issue">15</biblScope>
                                <biblScope unit="page" from="3573" to="3580" />
                                <date type="published" when="2000">2000</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b21">
                        <analytic>
                            <title level="a" type="main">An integrated method for spectrum extraction and compound identification from gas chromatography/mass spectrometry data</title>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">E</forename>
                                    <surname>Stein</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Am Soc Mass Spectr</title>
                            <imprint>
                                <biblScope unit="volume">10</biblScope>
                                <biblScope unit="issue">8</biblScope>
                                <biblScope unit="page" from="770" to="781" />
                                <date type="published" when="1999">1999</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b22">
                        <analytic>
                            <title level="a" type="main">A noise and background reduction method for component detection in liquid chromatography mass spectrometry</title>
                            <author>
                                <persName>
                                    <forename type="first">W</forename>
                                    <surname>Windig</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">M</forename>
                                    <surname>Phalp</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">W</forename>
                                    <surname>Payne</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Anal Chem</title>
                            <imprint>
                                <biblScope unit="volume">68</biblScope>
                                <biblScope unit="issue">20</biblScope>
                                <biblScope unit="page" from="3602" to="3606" />
                                <date type="published" when="1996">1996</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b23">
                        <monogr>
                            <title level="m" type="main">Rapid and Accurate Method for Estimating Molecular-Weights of Organic-Compounds from Low Resolution Mass-Spectra. Chemometr Intell Lab</title>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">R</forename>
                                    <surname>Scott</surname>
                                </persName>
                            </author>
                            <imprint>
                                <date type="published" when="1992">1992</date>
                                <biblScope unit="volume">16</biblScope>
                                <biblScope unit="page" from="193" to="202" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b24">
                        <monogr>
                            <ptr target="http://www.nist.gov/srd/nist1a.htm" />
                            <title level="m">NIST MS Search Program</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b25">
                        <analytic>
                            <title level="a" type="main">Automation of a Fourier transform ion cyclotron resonance mass spectrometer for acquisition, analysis, and E-mailing of high-resolution exact-mass electrospray ionization mass spectral data</title>
                            <author>
                                <persName>
                                    <forename type="first">N</forename>
                                    <surname>Huang</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <forename type="middle">M</forename>
                                    <surname>Siegel</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">G</forename>
                                    <forename type="middle">H</forename>
                                    <surname>Kruppa</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">F</forename>
                                    <forename type="middle">H</forename>
                                    <surname>Laukien</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Am Soc Mass Spectr</title>
                            <imprint>
                                <biblScope unit="volume">10</biblScope>
                                <biblScope unit="issue">11</biblScope>
                                <biblScope unit="page" from="1166" to="1173" />
                                <date type="published" when="1999">1999</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b26">
                        <monogr>
                            <ptr target="http://www.acdlabs.com/products/spec_lab/exp_spectra/ms/intellixtract/" />
                            <title level="m">ACD/IntelliXtract: LC/MS Software for Molecular Ion Determination</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b27">
                        <analytic>
                            <title level="a" type="main">Method for calculation of the number of rings in the structure of organic compounds</title>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">A</forename>
                                    <surname>Pontet</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Chimia</title>
                            <imprint>
                                <biblScope unit="volume">5</biblScope>
                                <biblScope unit="page" from="39" to="40" />
                                <date type="published" when="1951">1951</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b28">
                        <analytic>
                            <title level="a" type="main">Molecular Formula Generalized in Terms of Cyclic Elements of Structure</title>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <forename type="middle">D</forename>
                                    <surname>Soffer</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Science</title>
                            <imprint>
                                <biblScope unit="volume">127</biblScope>
                                <biblScope unit="issue">3303</biblScope>
                                <biblScope unit="page" from="880" to="880" />
                                <date type="published" when="1958">1958</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b29">
                        <analytic>
                            <title level="a" type="main">Molecular Formula and Degree of Unsaturation</title>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">A</forename>
                                    <surname>Laws</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Nature</title>
                            <imprint>
                                <biblScope unit="volume">200</biblScope>
                                <biblScope unit="issue">491</biblScope>
                                <biblScope unit="page">1202</biblScope>
                                <date type="published" when="1963">1963</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b30">
                        <monogr>
                            <title level="m" type="main">Computer-Aided Interpretation of Mass-Spectra .14. Stirs Prediction of Rings-Plus-Double-Bonds Values. Organic Mass Spectrometry</title>
                            <author>
                                <persName>
                                    <forename type="first">H</forename>
                                    <forename type="middle">E</forename>
                                    <surname>Dayringer</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">F</forename>
                                    <forename type="middle">W</forename>
                                    <surname>Mclafferty</surname>
                                </persName>
                            </author>
                            <imprint>
                                <date type="published" when="1977">1977</date>
                                <biblScope unit="volume">12</biblScope>
                                <biblScope unit="page" from="53" to="54" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b31">
                        <analytic>
                            <title level="a" type="main">A novel formalism to characterize the degree of unsaturation of organic molecules</title>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <surname>Badertscher</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">K</forename>
                                    <surname>Bischofberger</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <forename type="middle">E</forename>
                                    <surname>Munk</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <surname>Pretsch</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Chem Inf Comp Sci</title>
                            <imprint>
                                <biblScope unit="volume">41</biblScope>
                                <biblScope unit="issue">4</biblScope>
                                <biblScope unit="page" from="889" to="893" />
                                <date type="published" when="2001">2001</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b32">
                        <monogr>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <surname>Schuhmacher</surname>
                                </persName>
                            </author>
                            <ptr target="http://www.chemsoft.ch/" />
                            <title level="m">Chemical Formula Generator: Chefog</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b33">
                        <monogr>
                            <title level="m" type="main">Formula calculator (elemental composition calculator) HiRes MS vs</title>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Hau</surname>
                                </persName>
                            </author>
                            <ptr target="http://homepage.sunrise.ch/mysunrise/joerg.hau/sci/index.htm" />
                            <imprint>
                                <date>20050617</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b34">
                        <monogr>
                            <title level="m" type="main">Chemical bonding in hypervalent molecules: Is the octet rule relevant? Inorganic Chemistry</title>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <surname>Noury</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">B</forename>
                                    <surname>Silvi</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Gillespie</surname>
                                </persName>
                            </author>
                            <imprint>
                                <date type="published" when="2002">2002</date>
                                <biblScope unit="volume">41</biblScope>
                                <biblScope unit="page" from="2164" to="2172" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b35">
                        <analytic></analytic>
                        <monogr>
                            <title level="m">Senior JK: Partitions and Their Representative Graphs</title>
                            <imprint>
                                <date type="published" when="1951">1951</date>
                                <biblScope unit="volume">73</biblScope>
                                <biblScope unit="page" from="663" to="689" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b36">
                        <analytic>
                            <author>
                                <persName>
                                    <forename type="first">T</forename>
                                    <surname>Morikawa</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">B</forename>
                                    <forename type="middle">T</forename>
                                    <surname>Newbold</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="m">Analogous Odd-Even Parities in Mathematics and Chemistry</title>
                            <imprint>
                                <date type="published" when="2003">2003</date>
                                <biblScope unit="volume">12</biblScope>
                                <biblScope unit="page" from="445" to="450" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b37">
                        <analytic>
                            <title level="a" type="main">MOL-GEN-CID -A canonizer for molecules and graphs accessible through the Internet</title>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Braun</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <surname>Gugisch</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <surname>Kerber</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <surname>Laue</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <surname>Meringer</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">C</forename>
                                    <surname>Rucker</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">J Chem Inf Comp Sci</title>
                            <imprint>
                                <biblScope unit="volume">44</biblScope>
                                <biblScope unit="issue">2</biblScope>
                                <biblScope unit="page" from="542" to="548" />
                                <date type="published" when="2004">2004</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b38">
                        <monogr>
                            <ptr target="http://www.chemistry-development-kit.org/" />
                            <title level="m">Deterministic Structure Generator</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b39">
                        <analytic>
                            <title level="a" type="main">Recent developments of the Chemistry Development Kit (CDK) -An open-source Java library for chemo-and bioinformatics</title>
                            <author>
                                <persName>
                                    <forename type="first">C</forename>
                                    <surname>Steinbeck</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">C</forename>
                                    <surname>Hoppe</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <surname>Kuhn</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <surname>Floris</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <surname>Guha</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <forename type="middle">L</forename>
                                    <surname>Willighagen</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Current Pharmaceutical Design</title>
                            <imprint>
                                <biblScope unit="volume">12</biblScope>
                                <biblScope unit="issue">17</biblScope>
                                <biblScope unit="page" from="2111" to="2120" />
                                <date type="published" when="2006">2006</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b40">
                        <analytic>
                            <title level="a" type="main">Biological applications of fullerenes</title>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">W</forename>
                                    <surname>Jensen</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">R</forename>
                                    <surname>Wilson</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">I</forename>
                                    <surname>Schuster</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Bioorganic &amp; Medicinal Chemistry</title>
                            <imprint>
                                <biblScope unit="volume">4</biblScope>
                                <biblScope unit="issue">6</biblScope>
                                <biblScope unit="page" from="767" to="779" />
                                <date type="published" when="1996">1996</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b41">
                        <monogr>
                            <author>
                                <persName>
                                    <forename type="first">I</forename>
                                    <surname>Filippov</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">W</forename>
                                    <surname>Sm Ihlenfeldt</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <surname>Nicklaus</surname>
                                </persName>
                            </author>
                            <ptr target="http://cactus.nci.nih.gov/" />
                            <title level="m">Chemical Structure Lookup Service (CSLS); Chemicals and Chemoinformatics Tools and User Services</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b42">
                        <analytic>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">L</forename>
                                    <surname>Wheeler</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">T</forename>
                                    <surname>Barrett</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">A</forename>
                                    <surname>Benson</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">H</forename>
                                    <surname>Bryant</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">K</forename>
                                    <surname>Canese</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">V</forename>
                                    <surname>Chetvernin</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">M</forename>
                                    <surname>Church</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <surname>Dicuccio</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <surname>Edgar</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <surname>Federhen</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">L</forename>
                                    <forename type="middle">Y</forename>
                                    <surname>Geer</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">W</forename>
                                    <surname>Helmberg</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">Y</forename>
                                    <surname>Kapustin</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">L</forename>
                                    <surname>Kenton</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">O</forename>
                                    <surname>Khovayko</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Lipman</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">T</forename>
                                    <forename type="middle">L</forename>
                                    <surname>Madden</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">R</forename>
                                    <surname>Maglott</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Ostell</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">K</forename>
                                    <forename type="middle">D</forename>
                                    <surname>Pruitt</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">G</forename>
                                    <forename type="middle">D</forename>
                                    <surname>Schuler</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">L</forename>
                                    <forename type="middle">M</forename>
                                    <surname>Schriml</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <surname>Sequeira</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">T</forename>
                                    <surname>Sherry</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">K</forename>
                                    <surname>Sirotkin</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <surname>Souvorov</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">G</forename>
                                    <surname>Starchenko</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">T</forename>
                                    <forename type="middle">O</forename>
                                    <surname>Suzek</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <surname>Tatusov</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">T</forename>
                                    <forename type="middle">A</forename>
                                    <surname>Tatusova</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">L</forename>
                                    <surname>Wagner</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">E</forename>
                                    <surname>Yaschenko</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="m">Database resources of the national center for biotechnology information</title>
                            <imprint>
                                <date type="published" when="2006">2006</date>
                                <biblScope unit="volume">34</biblScope>
                                <biblScope unit="page" from="D173" to="D180" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b43">
                        <monogr>
                            <ptr target="http://www.metabolome.jp" />
                            <title level="m">Peptide and Metabolite molecular formula database</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b44">
                        <monogr>
                            <title level="m" type="main">Virtual exploration of the small-molecule chemical universe below 160 daltons. Angewandte Chemie-International Edition</title>
                            <author>
                                <persName>
                                    <forename type="first">T</forename>
                                    <surname>Fink</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">H</forename>
                                    <surname>Bruggesser</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">L</forename>
                                    <surname>Reymond</surname>
                                </persName>
                            </author>
                            <imprint>
                                <date type="published" when="2005">2005</date>
                                <biblScope unit="volume">44</biblScope>
                                <biblScope unit="page" from="1504" to="1508" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b45">
                        <analytic>
                            <title level="a" type="main">Enumerating molecules</title>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">L</forename>
                                    <surname>Faulon</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">P</forename>
                                    <surname>Visco</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <surname>Roe</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Reviews in Computational Chemistry</title>
                            <imprint>
                                <biblScope unit="volume">21</biblScope>
                                <biblScope unit="page" from="209" to="286" />
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b46">
                        <analytic>
                            <title level="a" type="main">DrugBank: a comprehensive resource for in silico drug discovery and exploration</title>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">S</forename>
                                    <surname>Wishart</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">C</forename>
                                    <surname>Knox</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">C</forename>
                                    <surname>Guo</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <surname>Shrivastava</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <surname>Hassanali</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <surname>Stothard</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">Z</forename>
                                    <surname>Chang</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Woolsey</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Nucleic Acids Research</title>
                            <imprint>
                                <biblScope unit="volume">34</biblScope>
                                <biblScope unit="page" from="D668" to="D672" />
                                <date type="published" when="2006">2006</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b47">
                        <analytic>
                            <title level="a" type="main">Multistage accurate mass spectrometry: A &quot;basket in a basket&quot; approach for structure elucidation and its application to a compound from combinatorial synthesis</title>
                            <author>
                                <persName>
                                    <forename type="first">Q</forename>
                                    <forename type="middle">Y</forename>
                                    <surname>Wu</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Anal Chem</title>
                            <imprint>
                                <biblScope unit="volume">70</biblScope>
                                <biblScope unit="issue">5</biblScope>
                                <biblScope unit="page" from="865" to="872" />
                                <date type="published" when="1998">1998</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b48">
                        <analytic>
                            <title level="a" type="main">Exact Molecular Mass Determination of Polar Plant Metabolites Using GCT with Chemical Ionization</title>
                            <author>
                                <persName>
                                    <forename type="first">O</forename>
                                    <surname>Fiehn</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">H</forename>
                                    <surname>Major</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="s">Waters Application Notes Waters</title>
                            <imprint>
                                <date type="published" when="2005">2005</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b49">
                        <analytic>
                            <title level="a" type="main">Inverted File Structure for Molecular Formula and Homologous Series Searching of Large Data-Bases</title>
                            <author>
                                <persName>
                                    <forename type="first">R</forename>
                                    <forename type="middle">G</forename>
                                    <surname>Dromey</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Anal Chem</title>
                            <imprint>
                                <biblScope unit="volume">49</biblScope>
                                <biblScope unit="issue">13</biblScope>
                                <biblScope unit="page" from="1982" to="1985" />
                                <date type="published" when="1977">1977</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b50">
                        <analytic>
                            <title/>
                            <ptr target="http://cactus.nci.nih.gov/lookup/" />
                        </analytic>
                        <monogr>
                            <title level="j">Chemical Structure Lookup Service</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b51">
                        <analytic>
                            <title level="a" type="main">NMRShiftDB -compound identification and structure elucidation support through a free community-built web database</title>
                            <author>
                                <persName>
                                    <forename type="first">C</forename>
                                    <surname>Steinbeck</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <surname>Kuhn</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Phytochemistry</title>
                            <imprint>
                                <biblScope unit="volume">65</biblScope>
                                <biblScope unit="issue">19</biblScope>
                                <biblScope unit="page" from="2711" to="2717" />
                                <date type="published" when="2004">2004</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b52">
                        <analytic>
                            <title level="a" type="main">Chemical structure indexing of toxicity data on the Internet: Moving toward a flat world</title>
                            <author>
                                <persName>
                                    <forename type="first">A</forename>
                                    <forename type="middle">M</forename>
                                    <surname>Richard</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">L</forename>
                                    <forename type="middle">S</forename>
                                    <surname>Gold</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <forename type="middle">C</forename>
                                    <surname>Nicklaus</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Current Opinion in Drug Discovery &amp; Development</title>
                            <imprint>
                                <biblScope unit="volume">9</biblScope>
                                <biblScope unit="issue">3</biblScope>
                                <biblScope unit="page" from="314" to="325" />
                                <date type="published" when="2006">2006</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b53">
                        <analytic>
                            <title level="a" type="main">Communication and reuse of chemical information in bioscience</title>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <surname>Murray-Rust</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">Jbo</forename>
                                    <surname>Mitchell</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">H</forename>
                                    <forename type="middle">S</forename>
                                    <surname>Rzepa</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Bmc Bioinformatics</title>
                            <imprint>
                                <biblScope unit="volume">6</biblScope>
                                <biblScope unit="page">180</biblScope>
                                <date type="published" when="2005">2005</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b54">
                        <monogr>
                            <title level="m" type="main">Open Source Chemistry Analysis Routines) -software for the semantic annotation of chemistry papers</title>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <surname>Corbett</surname>
                                </persName>
                            </author>
                            <ptr target="http://sourceforge.net/projects/oscar3-chem" />
                            <imprint>
                                <biblScope unit="page">R3</biblScope>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b55">
                        <analytic>
                            <title level="a" type="main">Enhanced CACTVS browser of the open NCI database</title>
                            <author>
                                <persName>
                                    <forename type="first">W</forename>
                                    <forename type="middle">D</forename>
                                    <surname>Ihlenfeldt</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">H</forename>
                                    <surname>Voigt</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">B</forename>
                                    <surname>Bienfait</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">F</forename>
                                    <surname>Oellien</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <forename type="middle">C</forename>
                                    <surname>Nicklaus</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Journal of Chemical Information and Computer Sciences</title>
                            <imprint>
                                <biblScope unit="volume">42</biblScope>
                                <biblScope unit="issue">1</biblScope>
                                <biblScope unit="page" from="46" to="57" />
                                <date type="published" when="2002">2002</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b56">
                        <monogr>
                            <title level="m" type="main">Databases -The journals of the 21(st) century. Internet Journal of Chemistry</title>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">R</forename>
                                    <surname>Heller</surname>
                                </persName>
                            </author>
                            <imprint>
                                <date type="published" when="1998">1998</date>
                                <biblScope unit="volume">1</biblScope>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b57">
                        <analytic>
                            <title level="a" type="main">InChI: Open access/open source and the IUPAC international chemical identifier</title>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">R</forename>
                                    <surname>Heller</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">E</forename>
                                    <surname>Stein</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">D</forename>
                                    <forename type="middle">V</forename>
                                    <surname>Tchekhovskoi</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Abstr Pap Am Chem S</title>
                            <imprint>
                                <biblScope unit="volume">230</biblScope>
                                <biblScope unit="page" from="U1025" to="U1026" />
                                <date type="published" when="2005">2005</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b58">
                        <monogr>
                            <ptr target="http://fiehnlab.ucdavis.edu/projects/Seven_Golden_Rules/" />
                            <title level="m">Seven Golden Rules Software</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b59">
                        <monogr>
                            <ptr target="http://www.chemnetbase.com" />
                            <title level="m">Dictionary of Natural Products</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b60">
                        <monogr>
                            <ptr target="http://www.chemaxon.com" />
                            <title level="m">ChemAxon JChem package v3.1.4 academic version</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b61">
                        <analytic>
                            <title level="a" type="main">ChemDB: a public database of small molecules and related chemoinformatics resources</title>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Chen</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">S</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Swamidass</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <surname>Bruand</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">P</forename>
                                    <surname>Baldi</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Bioinformatics</title>
                            <imprint>
                                <biblScope unit="volume">21</biblScope>
                                <biblScope unit="issue">22</biblScope>
                                <biblScope unit="page" from="4133" to="4139" />
                                <date type="published" when="2005">2005</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b62">
                        <analytic>
                            <title level="a" type="main">ZINC -A free database of commercially available compounds for virtual screening</title>
                            <author>
                                <persName>
                                    <forename type="first">J</forename>
                                    <forename type="middle">J</forename>
                                    <surname>Irwin</surname>
                                </persName>
                            </author>
                            <author>
                                <persName>
                                    <forename type="first">B</forename>
                                    <forename type="middle">K</forename>
                                    <surname>Shoichet</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Journal of Chemical Information and Modeling</title>
                            <imprint>
                                <biblScope unit="volume">45</biblScope>
                                <biblScope unit="issue">1</biblScope>
                                <biblScope unit="page" from="177" to="182" />
                                <date type="published" when="2005">2005</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b63">
                        <monogr>
                            <ptr target="http://www.microsoft.com/downloads" />
                            <title level="m">Windows Server 2003 Resource Kit Tool qgrep</title>
                            <imprint>
                                <publisher>Microsoft</publisher>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b64">
                        <monogr>
                            <ptr target="http://cactus.nci.nih.gov/SDF_toolkit/" />
                            <title level="m">SDF toolkit</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b65">
                        <analytic>
                            <title/>
                            <ptr target="http://www.statsoft.com" />
                        </analytic>
                        <monogr>
                            <title level="j">Statistica Dataminer</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b66">
                        <monogr>
                            <ptr target="http://en.wikipedia.org/wiki/SOAP" />
                            <title level="m">Definition of the SOAP protocol</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b67">
                        <monogr>
                            <ptr target="http://www.ncbi.nlm.nih.gov/entrez/query/static/eutils_help.html" />
                            <title level="m">Entrez Programming Utilities for Searching Entrez, the Life Sciences Search Engine</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b68">
                        <analytic>
                            <title level="a" type="main">JChem: Java applets and modules supporting chemical database handling from web browsers</title>
                            <author>
                                <persName>
                                    <forename type="first">F</forename>
                                    <surname>Csizmadia</surname>
                                </persName>
                            </author>
                        </analytic>
                        <monogr>
                            <title level="j">Journal of Chemical Information and Computer Sciences</title>
                            <imprint>
                                <biblScope unit="volume">40</biblScope>
                                <biblScope unit="issue">2</biblScope>
                                <biblScope unit="page" from="323" to="324" />
                                <date type="published" when="2000">2000</date>
                            </imprint>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b69">
                        <monogr>
                            <ptr target="http://fiehnlab.ucdavis.edu/staff/kind/Metabolomics/MS-Adduct-Calculator/" />
                            <title level="m">ESI MS adduct calculator</title>
                            <imprint/>
                        </monogr>
                    </biblStruct>
                    <biblStruct xml:id="b70">
                        <analytic>
                            <title level="a" type="main">Molecular Weight Calculator</title>
                            <author>
                                <persName>
                                    <forename type="first">M</forename>
                                    <surname>Monroe</surname>
                                </persName>
                            </author>
                            <ptr target="http://www.alchemistmatt.com/" />
                        </analytic>
                        <monogr>
                            <title level="m">MWTWIN v6</title>
                            <imprint>
                                <biblScope unit="volume">39</biblScope>
                            </imprint>
                        </monogr>
                    </biblStruct>
                </listBibl>
            </div>
        </back>
    </text>
</TEI>